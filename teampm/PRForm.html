<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
        integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@pdf-lib/fontkit@1.1.1/dist/fontkit.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
    <!-- icon -->
    <link rel="icon" href="https://img.icons8.com/3d-fluency/94/move-by-trolley.png" type="image/x-icon" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100%;
            height: 100%;
            font-family: 'Prompt', sans-serif;
            background-color: #e9b33b;
            /* background-color: #D3D3D3; */
        }

        #sticker {
            width: 100%;
            height: 100%;
        }
    </style>
    <title>PR Form</title>
</head>

<body>
    <header>
        <div class="container-fluid d-flex flex-column align-items-center justify-content-center w-100 mt-4">
            <div class="col-auto">
                <img width="80" src="https://img.icons8.com/3d-fluency/94/move-by-trolley.png" alt="move-by-trolley" />
            </div>

            <div class="col text-center">
                <h4 class="h1 fw-bold text-light">PR Form</h4>
            </div>
        </div>
    </header>
    <main>
        <div class="container-fluid">
            <form id="myForm" class="mt-3 mb-5">
                <section class="mt-4 m-2">
                    <div class="row">
                        <div class="col-md-4">
                            <label for="name">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Å‡∏£‡∏≠‡∏Å</label>
                            <select name="name" id="name" class="form-select">
                                <option value="" selected disabled>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Å‡∏£‡∏≠‡∏Å</option>
                                <option value="CHAIWAT SALAIWONG">CHAIWAT SALAIWONG</option>
                                <option value="PASSAWAN TOANUN">PASSAWAN TOANUN</option>
                                <option value="PANALEE UEASUNTHONNOP">PANALEE UEASUNTHONNOP</option>
                                <option value="SERMKEAT HADJANG">SERMKEAT HADJANG</option>
                                <option value="CHANCHAI SAE-LEE">CHANCHAI SAE-LEE</option>
                                <option value="SARAN THAMMATHORN">SARAN THAMMATHORN</option>
                                <option value="PUKARIN TONGKLIANG">PUKARIN TONGKLIANG</option>
                                <option value="ANUPHAB CHANTO">ANUPHAB CHANTO</option>
                                <option value="NARUECHA CHAIYAPHAN">NARUECHA CHAIYAPHAN</option>
                                <option value="ITTIPAT IEMDEE">ITTIPAT IEMDEE</option>
                                <option value="SASIMAPORN KHANTHAHOME">SASIMAPORN KHANTHAHOME</option>
                                <option value="DARANPHOP YIMYAM">DARANPHOP YIMYAM</option>
                                <option value="CHATVIPA KAEWPRESERT">CHATVIPA KAEWPRESERT</option>
                                <option value="PHIMRAPEEPORN PHRASOPOL">PHIMRAPEEPORN PHRASOPOL</option>
                                <option value="RAPIPHAN KHAMSUWAN">RAPIPHAN KHAMSUWAN</option>
                                <option value="SOM KONKAEW">SOM KONKAEW</option>
                            </select>
                        </div>
                    </div>
                </section>
                <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow">
                    <div class="row justify-content-end">
                        <div class="col-md-3 text-end">
                            <button class="btn btn-primary" id="auto-fill" type="button" data-bs-toggle="offcanvas"
                                data-bs-target="#autoFillOffCanvas" aria-controls="autoFillOffCanvas">Auto Fill</button>
                        </div>
                    </div>
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center mt-3">
                            <img src="https://img.icons8.com/external-flaticons-flat-flat-icons/64/external-defibrillator-medical-and-healthcare-flaticons-flat-flat-icons.png"
                                alt="icon" width="50">
                            <h4 class="fw-bold">&nbsp;‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</h4>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="job_id">Work Order</label>
                            <input type="text" name="job_id" id="job_id" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_name">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</label>
                            <input type="text" name="e_name" id="e_name" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="dept">‡πÅ‡∏ú‡∏ô‡∏Å</label>
                            <select name="dept" id="dept" class="form-select">
                                <option value="" disabled selected>Select value</option>
                                <option>ANESTHESIA (‡∏ß‡∏¥‡∏™‡∏±‡∏ç‡∏ç‡∏µ)</option>
                                <option>ART-LAB (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏ö‡∏∏‡∏ï‡∏£‡∏¢‡∏≤‡∏Å)</option>
                                <option>BME-PYT3</option>
                                <option>CATH-LAB</option>
                                <option>CHECK-UP (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û)</option>
                                <option>CORPORATE CUSTOMER SERVICE</option>
                                <option>CSSD (‡∏à‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏≤‡∏á)</option>
                                <option>DENTAL (‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°)</option>
                                <option>DIABETIC&amp;METABOLIC(‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô)</option>
                                <option>EENT( ‡∏´‡∏π‡∏ï‡∏≤‡∏Ñ‡∏≠‡∏à‡∏°‡∏π‡∏Å)</option>
                                <option>EMERGENCY( ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)</option>
                                <option>GASTROINTESTINAL LABORATORY(GI)</option>
                                <option>HEMODIALYSIS (‡πÑ‡∏ï‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)</option>
                                <option>HOPD CENTER (‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á)</option>
                                <option>INFECTION CONTROL ( IC)</option>
                                <option>INTENSIVE CARE UNIT(‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏ô‡∏±‡∏Å)</option>
                                <option>LABOR ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏•‡∏≠‡∏î)</option>
                                <option>LABORATORY</option>
                                <option>MAID</option>
                                <option>MARKETING</option>
                                <option>NURSERY(‡πÄ‡∏î‡πá‡∏Å‡∏≠‡πà‡∏≠‡∏ô)</option>
                                <option>NURSING DEPARTMENT</option>
                                <option>OBSERVE(‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£)</option>
                                <option>OPD CARDIO(‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏´‡∏±‡∏ß‡πÉ‡∏à)</option>
                                <option>OPD COUNTER NURSE (CN ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á)</option>
                                <option>OPD HEAD NECK BREAST(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°)</option>
                                <option>OPD MEDICINE(‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏£‡∏£‡∏°)</option>
                                <option>OPD NEURO (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏°‡∏≠‡∏á)</option>
                                <option>OPD OB/GYN(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ç‡∏¥‡∏á)</option>
                                <option>OPD PEDIATRIC( ‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡πá‡∏Å)</option>
                                <option>OPD SURGERY(‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°)</option>
                                <option>OPD UROLOGY (‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞)</option>
                                <option>OPERATING ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î)</option>
                                <option>PHARMARCY(‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤)</option>
                                <option>PHYATHAI BEAUTY CENTER (PBC ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°)</option>
                                <option>PHYSICAL THERAPY( ‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û)</option>
                                <option>PICU</option>
                                <option>PWA LIFE CENTER</option>
                                <option>PWA ‡∏ä‡∏∞‡∏•‡∏≠‡∏ß‡∏±‡∏¢</option>
                                <option>WARD 10</option>
                                <option>WARD 11</option>
                                <option>WARD 12</option>
                                <option>WARD 14</option>
                                <option>WARD 15</option>
                                <option>WARD 17</option>
                                <option>WARD 7</option>
                                <option>WARD 8</option>
                                <option>WARD 9</option>
                                <option>X-RAY</option>
                                <option>‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á</option>
                                <option>‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô 19</option>
                            </select>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_manufacturer">‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï</label>
                            <input type="text" name="e_manufacturer" id="e_manufacturer" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</label>
                            <input type="text" name="e_date" id="e_date" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_hospital_code">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</label>
                            <input type="text" name="e_hospital_code" id="e_hospital_code" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_brand/model">‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡∏£‡∏∏‡πà‡∏ô</label>
                            <input type="text" name="e_brand/model" id="e_brand/model" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_sn">‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (SN)</label>
                            <input type="text" name="e_sn" id="e_sn" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_me_code">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (ME Code)</label>
                            <input type="text" name="e_me_code" id="e_me_code" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="e_price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ <span class="text-secondary">(‡∏ö‡∏≤‡∏ó)</span></label>
                            <input type="text" name="e_price" id="e_price" class="form-control">
                        </div>
                        <div class="col-12 mt-3">
                            <label for="pr_failure">‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡∏¢</label>
                            <input type="text" name="pr_failure" id="pr_failure" class="form-control">
                        </div>
                        <div class="col-12 mt-3">
                            <label for="pr_result">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</label>
                            <input type="text" name="pr_result" id="pr_result" class="form-control">
                        </div>
                        <div class="col-12 mt-3">
                            <label for="pr_recommend">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</label>
                            <input type="text" name="pr_recommend" id="pr_recommend" class="form-control">
                        </div>

                        <div class="col-12 m-0 p-0">
                            <div class="row m-0 p-0">
                                <div class="col-md-4 mt-3">
                                    <div class="rounded bg-info-subtle d-flex align-items-center justify-content-center btn"
                                        id="e_img_div">
                                        <img height="40" src="https://img.icons8.com/fluency/48/image.png" alt="image"
                                            id="preview-img" />
                                        &nbsp;‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
                                    </div>
                                </div>
                                <div class="col-md-4 mt-3 ">
                                    <div class="rounded bg-info-subtle d-flex align-items-center justify-content-center btn"
                                        id="e_img_code_div">
                                        <img height="40" src="https://img.icons8.com/fluency/48/image.png" alt="image"
                                            id="preview-img-code" />
                                        &nbsp;‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡πâ‡∏î
                                    </div>
                                </div>
                                <div class="col-md-4 mt-3">
                                    <div class="rounded bg-info-subtle d-flex align-items-center justify-content-center btn"
                                        id="e_img_nameplate_div">
                                        <img height="40" src="https://img.icons8.com/fluency/48/image.png" alt="image"
                                            id="preview-img-nameplate" />
                                        &nbsp;‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û Nameplate
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="file" name="e_img_file" id="e_img_file" hidden>

                    </div>
                </section>
                <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow">
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center mt-3">
                            <img src="https://img.icons8.com/cotton/64/red-file--v2.png" alt="icon" width="50">
                            <h4 class="fw-bold">&nbsp;‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</h4>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_vender">Vender</label>
                            <input type="text" name="pr_vender" id="pr_vender" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_no">‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</label>
                            <input type="text" name="pr_no" id="pr_no" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ <span class="text-secondary">(‡∏ö‡∏≤‡∏ó)</span></label>
                            <input type="text" name="pr_price" id="pr_price" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_vat">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° 7% <span class="text-secondary">(‡∏ö‡∏≤‡∏ó)</span></label>
                            <input type="text" name="pr_vat" id="pr_vat" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_grand_price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô <span class="text-secondary">(‡∏ö‡∏≤‡∏ó)</span></label>
                            <input type="text" name="pr_grand_price" id="pr_grand_price" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_cm_estimated_send">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á <span
                                    class="text-secondary">(‡∏ß‡∏±‡∏ô)</span></label>
                            <input type="text" name="pr_cm_estimated_send" id="pr_cm_estimated_send"
                                class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_cm_standing">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤ <span class="text-secondary">(‡∏ß‡∏±‡∏ô)</span></label>
                            <input type="text" name="pr_cm_standing" id="pr_cm_standing" class="form-control">
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_cm_waranty">‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô <span class="text-secondary">(‡∏ß‡∏±‡∏ô)</span></label>
                            <input type="text" name="pr_cm_waranty" id="pr_cm_waranty" class="form-control">
                        </div>
                    </div>
                </section>
                <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow has-checkboxes">
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center mt-3">
                            <img src="https://img.icons8.com/stickers/100/bank.png" alt=" icon" width="50">
                            <h4 class="fw-bold">&nbsp;‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏≤‡πÄ‡∏™‡∏ô‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h4>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr-cm">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</label>
                            <select name="pr-cm" id="pr-cm" class="form-select">
                                <option value="MAINTENANCE" id="pr_cm_maintenance" selected>MAINTENANCE</option>
                                <option value="REPLACEMENT" id="pr_cm_replacement">REPLACEMENT</option>
                                <option value="Other" id="pr_cm_other">Other</option>
                            </select>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr_cm_maintenance_ea">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (ea)</label>
                            <input type="text" name="pr_cm_maintenance_ea" id="pr_cm_maintenance_ea"
                                class="form-control" value="1">
                        </div>
                        <div class="col-md-4 mt-3" style="display:none">
                            <label for="pr_cm_other_text">‡∏£‡∏∞‡∏ö‡∏∏</label>
                            <input type="text" name="pr_cm_other_text" id="pr_cm_other_text" class="form-control">
                        </div>
                    </div>
                </section>
                <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow has-checkboxes">
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center mt-3">
                            <img src="https://img.icons8.com/color/48/engineer.png" alt=" icon" width="50">
                            <h4 class="fw-bold">&nbsp;‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</h4>
                        </div>
                        <div class="col-12 m-0 p-0">
                            <div class="row m-0 p-0">
                                <div class="col col-md-4 mt-3">
                                    <label for="pr-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</label>
                                    <select name="pr-status" id="pr-status" class="form-select">
                                        <option value="Normal" id="pr_status_normal">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥</option>
                                        <option value="Waitpart" id="pr_status_waitpart">‡∏£‡∏≠‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</option>
                                        <option value="Vender" id="pr_status_vender">‡∏™‡πà‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
                                        <option value="Other" id="pr_status_other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                    </select>
                                </div>
                                <div class="col-8 mt-3" style="display:none">
                                    <label for="pr_status_other_text">‡∏£‡∏∞‡∏ö‡∏∏</label>
                                    <input type="text" name="pr_status_other_text" id="pr_status_other_text"
                                        class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="pr-process">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</label>
                            <select name="pr-process" id="pr-process" class="form-select">
                                <option value="" selected></option>
                                <option value="Waranty" id="pr_process_waranty">‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô</option>
                                <option value="Self" id="pr_process_self">‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏≠‡∏á</option>
                                <option value="Vender" id="pr_process_vender">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
                                <option value="Changepart" id="pr_process_changepart">‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</option>
                                <option value="Other" id="pr_process_other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                    </div>
                </section>
                <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow">
                    <div class="row justify-content-center align-items-start">
                        <div class="col-md-6 mt-3 text-center">
                            <label for="1-file-nsmart">‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ö‡∏á‡∏≤‡∏ô NSmart</label>
                            <input type="file" name="1-file-nsmart" accept="application/pdf" id="1-file-nsmart"
                                class="form-control file">
                            <iframe class="mt-2" frameborder="0" notoolbar=1
                                style="display: none; width: 100%; height: calc(100vw *(1.4142/3.45));"></iframe>
                        </div>
                        <div class="col-md-6 mt-3 text-center">
                            <label for="2-file-quatation">‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</label>
                            <input type="file" name="2-file-quatation" id="2-file-quatation" accept="application/pdf"
                                class="form-control file">
                            <iframe class="mt-2" frameborder="0" notoolbar=1
                                style="display: none; width: 100%; height: calc(100vw *(1.4142/3.45));"></iframe>
                        </div>
                    </div>
                </section>
                <div class="row justify-content-center">
                    <div class="col-md-4 mt-3 text-center">
                        <button type="submit" class="btn btn-warning btn-lg shadow" style="min-width: 200px;"><img
                                width="40" src="https://img.icons8.com/3d-fluency/94/pdf.png" alt="pdf" />
                            ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå</button>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-4 mt-3 mb-4 text-center">
                        <a id="a-download" target="_blank" style="display: none;" class="fw-bold">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</a>
                    </div>
                </div>
            </form>
            <div class="container-fluid">
                <iframe id="pdf" style="width: 100%; height: calc(100vw *(1.4142)); display: none;"></iframe>
            </div>
        </div>

    </main>

    <div class="offcanvas offcanvas-end" data-bs-scroll="true" tabindex="-1" id="autoFillOffCanvas"
        aria-labelledby="autoFillOffCanvasLabel">

        <div class="offcanvas-body container-fluid">
            <div class="alert alert-info" role="alert">
                <div class="row">
                    <div class="col m-0">
                        <input name="console-code" id="console-code" class="form-control"
                            value='console.clear(),console.group("START");let page=location.origin+location.pathname;console.log("üöÄ !! page:",page);var e,copy=e=>{console.log("Copying to clipboard...");let t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),console.log("END"),console.groupEnd()};if(page.indexOf("//nsmart.nhealth-asia.com/MTDPDB01/asset_mast_record.php")>-1)console.log("Getting data..."),copy(JSON.stringify({page:"addupdate",id:document.getElementsByName("sap_code")[0].value,name:(e=document.getElementsByName("catagory")[0]).options[e.selectedIndex].innerText,brand:document.getElementsByName("brand")[0].value,model:document.getElementsByName("model")[0].value,sn_no:document.getElementsByName("serial_no")[0].value,dept:(e=document.getElementsByName("sub_dept")[0]).options[e.selectedIndex].innerText,recieve_date:document.getElementsByName("receive_date")[0].value,warranty_end:document.getElementsByName("w_finish_date_repair_part")[0].value,price:document.getElementsByName("price")[0].value,hos_id:document.getElementsByName("code_equip")[0].value,sup_sale:(e=document.getElementsByName("sup_sale")[0]).options[e.selectedIndex].innerText,pr_vender:(e=document.getElementsByName("sup_serv")[0]).options[e.selectedIndex].innerText}));else if(page.indexOf("//nsmart.nhealth-asia.com/MTDPDB01/jobs/BJOBA_05.php")>-1){let e=document.getElementsByName("job_status")[0].value;if(console.log("üöÄ !! status:",e),12==e){let e,t,l=document.getElementsByName("note")[0].value,o=document.querySelectorAll("th");for(let t=0;t<o.length;t++){let n=o[t];"Work order no."===n.innerText&&(e=n.nextElementSibling.innerText.trim())}for(let e=0;e<o.length;e++){let n=o[e];"ID CODE"===n.innerText&&(t=n.nextElementSibling.innerText.trim())}a=l.split("\n")[4].split(" ")[2].trim().replace(",",""),a=Number(a),i=(a/1.07).toFixed(2),n=(a-i).toFixed(2),a=a.toFixed(2),copy(JSON.stringify({page:"closejob",quatation:l.split("\n")[1].split(":")[1].trim(),month:l.split("\n")[3].split("- ")[1].trim(),price:a,vat:n,base_price:i,job_no:e})),window.open("https://nsmart.nhealth-asia.com/MTDPDB01/asset_mast_list_new.php?s_code=&s_sap_code="+t,"_self")}else{var r=document.querySelectorAll("select[name=\"bec_id\"] option");for(let e=0;e<r.length;e++){let t=r[e];"12-Service contract"===t.innerText&&(t.selected=!0)}r=document.querySelectorAll("input[name=\"jobout_type\"]");for(let e=0;e<r.length;e++){let t=r[e];"2"==t.value&&(t.checked=!0)}let e=document.querySelectorAll("input[name=\"req_date1\"]")[0].value,t=(e=e.indexOf(", ")>-1?e.split(", "):e.split(" "))[0].split("/").map(Number);e=e[1].split(":"),e=new Date(t[2],t[1]-1,t[0],e[0],e[1]),document.querySelectorAll("input[name=\"jobdate\"]")[0].value=document.querySelectorAll("input[name=\"req_date1\"]")[0].value,document.querySelectorAll("input[name=\"assign_date\"]")[0].value=document.querySelectorAll("input[name=\"req_date1\"]")[0].value,document.querySelectorAll("input[name=\"arrive_date\"]")[0].value=new Date(e.setMinutes(e.getMinutes()+2)).toLocaleString("en-GB",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(",",""),document.querySelectorAll("input[name=\"act_dstart\"]")[0].value=document.querySelectorAll("input[name=\"arrive_date\"]")[0].value,document.querySelectorAll("input[name=\"act_dfin\"]")[0].value=new Date(e.setMinutes(e.getMinutes()+2)).toLocaleString("en-GB",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(",",""),r=document.querySelectorAll("select[name=\"job_result\"] option");for(let e=0;e<r.length;e++){let t=r[e];"Self repair"===t.innerText&&(t.selected=!0)}document.getElementsByName("note")[0].value="- \n- ‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: \n- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô  ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏£‡∏∞‡∏¢‡∏∞‡∏ß‡∏•‡∏≤   ‡∏õ‡∏µ\n- ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: \n- ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô  ‡∏ö‡∏≤‡∏ó"}}'
                            readonly>
                    </div>
                    <div class="col-auto m-0">
                        <button class="btn btn-warning" onclick="copy()"><span id="copy-icon"><img width="20"
                                    src="https://img.icons8.com/cotton/64/documents.png"
                                    alt="documents" /></span>&nbsp;Copy</button>
                    </div>
                </div>
            </div>
            <div class="row g-3">
                <div class="col-12">
                    <textarea name="input-json" id="input-json" class="form-control" rows="10"
                        placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤ Add Update"></textarea>
                </div>
                <div class="col-12">
                    <button class="btn btn-primary w-100" id="input-json-btn"><img width="30"
                            src="https://img.icons8.com/color/48/task--v1.png" alt="task--v1" /> ‡∏Å‡∏£‡∏≠‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        const scriptUrl = 'https://script.google.com/macros/s/AKfycbwnb57VU-CveziAzWMWtFfbnXiX_mZIWJERI_XLLnNEILEgapodymzeFcWcxMry86EA5Q/exec'
        var form_pdf_bytes, font_bytes, signature_bytes, e_img_bytes, e_img_code_bytes, e_img_nameplate_bytes
        $(document).ready(async function () {
            form_pdf_bytes = await fetch('./formPR.pdf').then(res => res.arrayBuffer())
            font_bytes = await fetch('./THSarabun.ttf').then(res => res.arrayBuffer())
        })
        $('#dept option').not(':disabled').each(function () {
            $(this).val($(this).text());
        });
        $('#input-json').on('keyup', function () {
            // detect enter key
            if (event.keyCode == 13) {
                $('#input-json-btn').click()
            }
        })
        $('#name').change(async function () {
            let name = $(this).val()
            signature_bytes = await fetch('../img_sign/' + name.replace(/ /g, '_') + '.png').then(res => res.arrayBuffer())

        })

        $('#pr-cm').change(function () {
            let data_id = $(this).find('option:selected').attr('id')
            $(this).attr('data-id', data_id)
            if (data_id == 'pr_cm_maintenance') {
                $('#pr_cm_maintenance_ea').val('1').parent().show()
            } else {
                $('#pr_cm_maintenance_ea').val('').parent().hide()
            }
            if (data_id == 'pr_cm_other') {
                showOtherFieldInput('pr_cm_other_text')
            } else {
                $('#pr_cm_other_text').val('').parent().hide()
            }

        })
        $('#pr-status').change(function () {
            let data_id = $(this).find('option:selected').attr('id')
            $(this).attr('data-id', data_id)
            if (data_id == 'pr_status_other') {
                showOtherFieldInput('pr_status_other_text')
            } else {
                $('#pr_status_other_text').val('').parent().hide()
            }
        })
        $('#e_img_div, #e_img_code_div, #e_img_nameplate_div').on('click', function () {
            $('#e_img_file').attr('data-id', $(this).attr('id')).click()
        })

        $('#e_img_div, #e_img_code_div, #e_img_nameplate_div').on('dragover', function (e) {
            e.preventDefault()
            e.stopPropagation()
            $(this).removeClass('bg-info-subtle').addClass('text-bg-info')
        })
        $('#e_img_div, #e_img_code_div, #e_img_nameplate_div').on('dragleave', function (e) {
            e.preventDefault()
            e.stopPropagation()
            $(this).removeClass('text-bg-info').addClass('bg-info-subtle')
        })

        $('#e_img_div, #e_img_code_div, #e_img_nameplate_div').on('drop', function (e) {
            e.preventDefault()
            e.stopPropagation()
            let dataID = $(this).attr('id')
            $('#e_img_file').attr('data-id', dataID)

            let preview = $('#' + dataID + ' img')
            $('#' + dataID).LoadingOverlay('show')
            // check if file is url
            if (e.originalEvent.dataTransfer.getData('text/uri-list')) {
                preview.attr('src', e.originalEvent.dataTransfer.getData('text/uri-list'))

                // getArrayBuffer from url
                $.ajax({
                    url: scriptUrl,
                    method: 'POST',
                    data: {
                        url: preview.attr('src'),
                        opt: 'getImage'
                    },
                    success: function (data) {



                        // convert base64 to file
                        let file = new File([base64ToArrayBuffer(data.base64)], 'filename', {
                            type: data.type,
                            lastModified: Date.now()
                        })

                        let quality = getCompressionQuality(file)


                        new Compressor(file, {
                            quality: quality,
                            success(result) {

                                let fr = new FileReader()
                                fr.onload = function (e) {
                                    setImageBytes(dataID, e.target.result)
                                    preview.attr('data-type', data.type.split('/')[1])
                                    $('#' + dataID).LoadingOverlay('hide')
                                }
                                fr.readAsArrayBuffer(result)
                            },
                            error(err) {
                                console.log(err.message);
                            },
                        });

                    }
                })
                return
            }
            let file = e.originalEvent.dataTransfer.files[0]
            if (!file) {
                return
            }
            let quality = getCompressionQuality(file)

            new Compressor(file, {
                quality: quality,
                success(result) {
                    let reader = new FileReader()
                    reader.onloadend = function (e) {

                        preview.attr('src', e.target.result).attr('data-type', file.type.split('/')[1])
                        // convert dataURL to arrayBuffer

                        setImageBytes(dataID, e.target.result)
                        $('#' + dataID).LoadingOverlay('hide')

                    }
                    reader.readAsDataURL(file)
                },
                error(err) {
                    console.log(err.message);
                },
            });
        })

        $('#e_img_file').change(function () {
            let dataID = $('#e_img_file').attr('data-id')
            let preview = $('#' + dataID + ' img')
            $('#' + dataID).LoadingOverlay('show')
            let file = $(this)[0].files[0]
            let quality = getCompressionQuality(file)
            new Compressor(file, {
                quality: quality,

                // The compression process is asynchronous,
                // which means you have to access the `result` in the `success` hook function.
                success(result) {
                    let reader = new FileReader()

                    reader.onloadend = function (e) {
                        preview.attr('src', e.target.result).attr('data-type', file.type.split('/')[1])
                        setImageBytes(dataID, e.target.result)
                        $('#' + dataID).LoadingOverlay('hide')

                    }
                    reader.readAsDataURL(result)
                },
                error(err) {
                    console.log(err.message);
                },
            });
        })
        // $('#autoFillOffCanvas').offcanvas('show')

        $('#pr_price').on('keyup', function () {
            let price = $(this).val()
            let vat = price * 0.07
            let total = price * 1.07
            if (isNaN(price)) return
            if (isNaN(vat)) return
            if (isNaN(total)) return
            $('#pr_vat').val(vat.toFixed(2))
            $('#pr_grand_price').val(total.toFixed(2))
        })
        $('#pr_vat').on('keyup', function () {
            let vat = $(this).val()
            let total = Number($('#pr_price').val()) + Number(vat)
            if (isNaN(vat)) return
            if (isNaN(total)) return
            $('#pr_grand_price').val(total.toFixed(2))
        })

        function showOtherFieldInput(key) {
            Swal.fire({
                title: '‡∏£‡∏∞‡∏ö‡∏∏ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ',
                input: 'text',
                inputLabel: '‡∏£‡∏∞‡∏ö‡∏∏',
                inputPlaceholder: '‡∏£‡∏∞‡∏ö‡∏∏',
                showCancelButton: true,
                inputValidator: (value) => {
                    if (!value) {
                        return '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'
                    }
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    $('#' + key).val(result.value).parent().show()
                }
            })
        }

        function base64ToArrayBuffer(base64) {
            var binaryString = atob(base64);
            var bytes = new Uint8Array(binaryString.length);
            for (var i = 0; i < binaryString.length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }

            return bytes.buffer;
        }

        function getCompressionQuality(file) {
            let quality = 0.3
            switch (true) {
                case file.size / 1024 <= 200:
                    quality = 0.8
                    break;

                case file.size / 1024 <= 600:
                    quality = 0.6
                    break;

                case file.size / 1024 <= 2000:
                    quality = 0.4
                    break;
                default:
                    quality = 0.3
                    break;
            }
            return quality
        }

        function setImageBytes(dataID, file) {
            if (typeof file == 'string') file = base64ToArrayBuffer(file.split(',')[1])
            switch (dataID) {
                case 'e_img_div':
                    e_img_bytes = file
                    break;
                case 'e_img_code_div':
                    e_img_code_bytes = file
                    break;
                case 'e_img_nameplate_div':
                    e_img_nameplate_bytes = file
                    break;
                default:
                    break;
            }
        }
    </script>
    <script>
        var pdfDoc
        var PDFDocument = PDFLib.PDFDocument;
        var StandardFonts = PDFLib.StandardFonts;
        var pdfFiles = []
        $('#1-file-nsmart, #2-file-quatation').on('dragover', function (e) {
            e.preventDefault()
            e.stopPropagation()
            $(this).addClass('text-bg-info')
        })
        $('#1-file-nsmart, #2-file-quatation').on('dragleave', function (e) {
            e.preventDefault()
            e.stopPropagation()
            $(this).removeClass('text-bg-info')
        })
        $('#1-file-nsmart, #2-file-quatation').on('drop', function (e) {
            e.preventDefault()
            e.stopPropagation()
            $(this).removeClass('from-control-lg')
            let files = e.originalEvent.dataTransfer.files
            let file = files[0]
            if(!file) return;
            // set files to $(this)
            $(this).prop('files', files)
            renderNsmartFile(file, $(this))
        })

        $('#1-file-nsmart, #2-file-quatation').on('change', function (e) {
            let files = e.target.files
            let file = files[0]
            if(!file) return;
            renderNsmartFile(file, $(this))
        })

        function renderNsmartFile(file, ele) {
            if (file.type != 'application/pdf') {
                Swal.fire({
                    icon: 'error',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF',
                    text: '‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà PDF',
                })
                return
            }
            if (file.size > 10000000) {
                Swal.fire({
                    icon: 'error',
                    title: '‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ',
                    text: '‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10 MB',
                })
                return
            }
            let obj = $(ele)
            let id = obj.attr('id')
            let reader = new FileReader()
            reader.onloadend = async function (e) {
                if (!pdfDoc) pdfDoc = await PDFDocument.load(form_pdf_bytes)
                pdfFiles[id] = e.target.result
                // load pdf
                let pdf = await PDFDocument.load(e.target.result)
                let pages = pdf.getPages().length
                for (var i = 0; i < pages; i++) {
                    let [page] = await pdfDoc.copyPages(pdf, [i])
                    pdfDoc.insertPage(1, page)
                }
                pdf = await pdf.save()
                let iframe = $(obj).parent().find('iframe')[0]
                var blob = new Blob([pdf], {
                    type: 'application/pdf'
                })
                var url = URL.createObjectURL(blob)
                iframe.src = url + '#toolbar=1&view=fitH'

                $(iframe).show()

            }
            reader.readAsArrayBuffer(file);
        }

        $('#myForm').submit(async function () {
            const embedImage = async function (bytes, key) {
                let preview, e_img
                switch (key) {
                    case 'e_img_file':
                        preview = $('#preview-img')
                        break;
                    case 'e_img_code_file':
                        preview = $('#preview-img-code')
                        break;
                    case 'e_img_nameplate_file':
                        preview = $('#preview-img-nameplate')
                        break;
                    default:
                        break;
                }
                if (preview.attr('data-type') == 'png') {
                    e_img = await pdfDoc.embedPng(bytes)
                } else if (preview.attr('data-type') == 'jpg') {
                    e_img = await pdfDoc.embedJpg(bytes)
                } else if (preview.attr('data-type') == 'jpeg') {
                    e_img = await pdfDoc.embedJpg(bytes)
                }
                return e_img
            }
            $.LoadingOverlay("show");
            event.preventDefault()

            if (!pdfDoc) pdfDoc = await PDFDocument.load(form_pdf_bytes)
            var form = pdfDoc.getForm()
            pdfDoc.registerFontkit(fontkit);
            const sarabun = await pdfDoc.embedFont(font_bytes, { subset: true })
            const symbol = await pdfDoc.embedFont(StandardFonts.ZapfDingbats, { subset: true })
            var signature, e_img
            if (signature_bytes) {
                signature = await pdfDoc.embedPng(signature_bytes)
            }
            let imgs_obj = {}
            if (e_img_bytes) {
                imgs_obj['e_img'] = await embedImage(e_img_bytes, 'e_img_file')
            }
            if (e_img_code_bytes) {
                imgs_obj['e_img_code'] = await embedImage(e_img_code_bytes, 'e_img_code_file')
            }
            if (e_img_nameplate_bytes) {
                imgs_obj['e_img_nameplate'] = await embedImage(e_img_nameplate_bytes, 'e_img_nameplate_file')
            }

            form.getTextField('pmhee').setText('‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏±‡∏¢‡∏ß‡∏±‡∏í‡∏ô‡πå ‡πÑ‡∏™‡∏•‡∏ß‡∏á‡∏©‡πå')
            form.getTextField('BME').setText('‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏û‡∏ç‡∏≤‡πÑ‡∏ó 3')
            form.getTextField('pr_date').setText((new Date().toLocaleDateString('en-GB', { year: 'numeric', month: 'long', day: 'numeric' }).toLocaleUpperCase()))
            form.getTextField('pr_date_short').setText((new Date().toLocaleDateString('en-GB', { year: 'numeric', month: 'numeric', day: 'numeric' })))
            $('form input').each(function () {
                let _this = $(this)
                if (_this.val() == '') return
                if (['e_manufacturer', 'e_sn', 'e_img_file', '1-file-nsmart', '2-file-quatation'].includes(_this.prop('id'))) return
                if (['pr_price', 'pr_vat', 'pr_grand_price'].includes(_this.prop('id'))) {
                    let value = Number(_this.val())
                    if (value != NaN) {
                        value = value.toFixed(2).split('.')

                        value[0] = Number(value[0]).toLocaleString()

                        form.getTextField(_this.prop('id')).setText(value.join('.'))
                    }
                    return
                }
                if (_this.prop('id') == 'e_brand/model') {
                    let val = _this.val().split('/')
                    form.getTextField('e_brand').setText(val[0])
                    form.getTextField('e_model').setText(val[1])
                    return
                }
                form.getTextField(_this.prop('id')).setText(_this.val())
                if (_this.prop('id') == 'e_name') {
                    form.getTextField(_this.prop('id'), { paragraphs: true, alignment: 'below' })
                }
            })
            $('.has-checkboxes option').each(function () {
                if ($(this).prop('id') == '') {
                    return
                }
                if ($(this).is(':selected')) {
                    let textField = form.getTextField($(this).prop('id'))
                    textField.setText('‚úì')
                    textField.updateAppearances(symbol)

                } else {
                    form.getTextField($(this).prop('id')).setText('')
                }
            })
            if (signature) form.getTextField('bme_sign').setImage(signature)
            if (imgs_obj['e_img']) form.getTextField('e_img').setImage(imgs_obj['e_img'])
            if (imgs_obj['e_img_code']) form.getTextField('e_img_code').setImage(imgs_obj['e_img_code'])
            if (imgs_obj['e_img_nameplate']) form.getTextField('e_img_nameplate').setImage(imgs_obj['e_img_nameplate'])
            form.updateFieldAppearances(sarabun);
            form.flatten()
            if (!e_img_bytes && !e_img_code_bytes && !e_img_nameplate_bytes) {
                // remove last page
                pdfDoc.removePage(pdfDoc.getPages().length - 1)
            }
            var pdfBytes = await pdfDoc.save()
            var pdfdatauri = await pdfDoc.saveAsBase64({ dataUri: true })
            let form_obj = {}
            $('#myForm input:not([type="file"]), select').each(function () {
                form_obj[$(this).attr('name')] = $(this).val()
            })
            form_obj['pdfFile'] = pdfdatauri
            $.ajax({
                url: scriptUrl,
                type: 'POST',
                data: {
                    opt: 'save',
                    form_obj: JSON.stringify(form_obj)
                }
            })
            $.LoadingOverlay("hide");
            Swal.fire({
                icon: 'success',
                title: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',
                timer: 2000,
                showConfirmButton: false,
            }).then(async () => {
                var iframe = document.getElementById('pdf')
                // open pdf in new small window
                var blob = new Blob([pdfBytes], { type: 'application/pdf' })
                var url = URL.createObjectURL(blob)
                iframe.src = url + '#toolbar=1&view=fitH'
                let e_code = $('#e_me_code').val() ? $('#e_me_code').val() : 'no_code'
                let e_name = $('#e_name').val() ? $('#e_name').val() : 'no_name'
                let dept = $('#dept').val() ? $('#dept').val() : 'no_department'
                let name = 'PR-' + e_code + '-' + e_name + '-' + dept + '.pdf'
                $(iframe).show(200)
                $('#a-download').attr('href', url)
                $('#a-download').attr('download', name).show()
                // scroll to pdf
                $('html, body').animate({
                    scrollTop: $(iframe).offset().top
                }, 500);
                pdfDoc = await PDFDocument.load(form_pdf_bytes)
                $('#1-file-nsmart, #2-file-quatation').change()

            })
            // $('#a-download').attr('href', pdfDataUri)
            // $('#a-download').attr('download', name).show()
        })
        function toTitleCase(str) {
            return str.replace(
                /\w\S*/g,
                function (txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                }
            );
        }
    </script>
    <script>
        function copy() {
            let str = $('#console-code').val()

            // copy to clipboard

            $('#console-code')[0].select()
            document.execCommand("copy")
            let Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 2000,
                timerProgressBar: false
            })
            Toast.fire({
                icon: 'success',
                title: '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'
            })
            console.groupEnd()
        }

        $('#input-json-btn').click(function () {
            let json_text = $('#input-json').val()
            let obj = JSON.parse(json_text)
            if (obj.page == 'addupdate') {
                fillValue('e_name', obj.name)
                fillValue('dept', obj.dept)
                fillValue('e_manufacturer', obj.brand)
                fillValue('e_date', obj.recieve_date)
                fillValue('e_hospital_code', obj.hos_id)
                fillValue('e_brand/model', ['/', obj.brand, obj.model])
                fillValue('e_brand/distributor', obj.sup_sale)
                fillValue('e_sn', obj.sn_no)
                fillValue('e_me_code', obj.id)
                fillValue('e_price', obj.price)
                fillValue('pr_vender', obj.pr_vender)
            } else if (obj.page == 'closejob') {
                fillValue('pr_no', obj.quatation)
                fillValue('pr_price', obj.base_price)
                fillValue('pr_vat', obj.vat)
                fillValue('pr_grand_price', obj.price)
                fillValue('job_id', obj.job_no)
            }

            $('#input-json').val('')
            $('#autoFillOffCanvas').offcanvas('hide')
        })

        function fillValue(id, value) {
            if (Array.isArray(value)) {
                let chain = value.shift()
                value = value.map((v) => {
                    return v ? v : ''
                })
                return fillValue(id, value.join(chain))

            }
            if (!value || value == '') value = 'N/A'
            $('[id="' + id + '"]').val(value).addClass('bg-primary-subtle')
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/compressorjs@1.2.1/dist/compressor.min.js"></script>
</body>

</html>