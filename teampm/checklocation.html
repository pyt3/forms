<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equip="Cache-control" content="no-cache , no-store, must-revalidate">
    <meta http-equip="Pragma" content="no-cache">
    <meta http-equip="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"
        integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
    <link rel=" stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', sans-serif;
        }

        img#profile {
            width: 60px;
            height: 60px;
            object-fit: cover;
        }

        .blink-border {
            animation: 1s linear infinite condemned_blink_effect;
        }

        @keyframes condemned_blink_effect {

            /* red border with 2px width  and growing text*/
            0% {
                border: 2px solid #ffffff;
                color: #ffffff;
            }

            50% {
                border: 2px solid #ff0000;
                color: #ff0000;
            }

            100% {
                border: 2px solid #ffffff;
                color: #ffffff;
            }
        }

        .select2-container--open {
            z-index: 99999999999999;
        }
    </style>
</head>

<body>
    <nav class="navbar bg-light">
        <div class="container-fluid fs-2 text-info fw-bold d-flex justify-content-center">
            ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå
        </div>
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="https://www.appdisqus.com/wp-content/uploads/2015/02/despicable_me_2_minions-1920x1080.jpg"
                    alt="profile" id="profile" class="rounded-circle border d-inline-block align-text-top">
                &nbsp; <div>
                    <span id="displayName">Team PM</span>
                </div>
            </a>
        </div>
    </nav>
    <!-- <div class="container">
        <div class="row justify-contain-center py-3 g-3">
            <div class="col-12 text-center">
                <label for="team" class="h3 fw-bold text-primary">TEAM</label>
                <select name="team" id="team" class="form-select text-center">
                    <option value="" selected disabled>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°</option>
                    <option value="team PM">team PM</option>
                    <option value="team CAL">team CAL</option>
                    <option value="VENDER">VENDER</option>
                </select>
            </div>
            <div class="col-12 text-center">
                <label for="dept" class="h3 fw-bold text-success">‡πÅ‡∏ú‡∏ô‡∏Å</label>
                <select type="text" class="form-select text-center" id="dept">
                    <option value="" selected disabled>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option>
                    <option value="ANESTHESIA (‡∏ß‡∏¥‡∏™‡∏±‡∏ç‡∏ç‡∏µ)">ANESTHESIA (‡∏ß‡∏¥‡∏™‡∏±‡∏ç‡∏ç‡∏µ)</option>
                    <option value="ART-LAB (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏ö‡∏∏‡∏ï‡∏£‡∏¢‡∏≤‡∏Å)">ART-LAB (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏ö‡∏∏‡∏ï‡∏£‡∏¢‡∏≤‡∏Å)</option>
                    <option value="BME-PYT3">BME-PYT3</option>
                    <option value="CATH-LAB">CATH-LAB</option>
                    <option value="CHECK-UP (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û)">CHECK-UP (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û)</option>
                    <option value="CORPORATE CUSTOMER SERVICE">CORPORATE CUSTOMER SERVICE</option>
                    <option value="CSSD (‡∏à‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏≤‡∏á)">CSSD (‡∏à‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏≤‡∏á)</option>
                    <option value="DENTAL (‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°)">DENTAL (‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°)</option>
                    <option value="DIABETIC&amp;METABOLIC(‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô)">DIABETIC&amp;METABOLIC(‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô)</option>
                    <option value="EENT( ‡∏´‡∏π‡∏ï‡∏≤‡∏Ñ‡∏≠‡∏à‡∏°‡∏π‡∏Å)">EENT( ‡∏´‡∏π‡∏ï‡∏≤‡∏Ñ‡∏≠‡∏à‡∏°‡∏π‡∏Å)</option>
                    <option value="EMERGENCY( ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)">EMERGENCY( ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)</option>
                    <option value="GASTROINTESTINAL LABORATORY(GI)">GASTROINTESTINAL LABORATORY(GI)</option>
                    <option value="HEMODIALYSIS (‡πÑ‡∏ï‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)">HEMODIALYSIS (‡πÑ‡∏ï‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)</option>
                    <option value="HOPD CENTER (‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á)">HOPD CENTER (‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á)</option>
                    <option value="INFECTION CONTROL ( IC)">INFECTION CONTROL ( IC)</option>
                    <option value="INTENSIVE CARE UNIT(‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏ô‡∏±‡∏Å)">INTENSIVE CARE UNIT(‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏ô‡∏±‡∏Å)</option>
                    <option value="LABOR ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏•‡∏≠‡∏î)">LABOR ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏•‡∏≠‡∏î)</option>
                    <option value="LABORATORY">LABORATORY</option>
                    <option value="MAID">MAID</option>
                    <option value="MARKETING">MARKETING</option>
                    <option value="NURSERY(‡πÄ‡∏î‡πá‡∏Å‡∏≠‡πà‡∏≠‡∏ô)">NURSERY(‡πÄ‡∏î‡πá‡∏Å‡∏≠‡πà‡∏≠‡∏ô)</option>
                    <option value="NURSING DEPARTMENT">NURSING DEPARTMENT</option>
                    <option value="OBSERVE(‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£)">OBSERVE(‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£)</option>
                    <option value="OPD CARDIO(‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏´‡∏±‡∏ß‡πÉ‡∏à)">OPD CARDIO(‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏´‡∏±‡∏ß‡πÉ‡∏à)</option>
                    <option value="OPD COUNTER NURSE (CN ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á)">OPD COUNTER NURSE (CN ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á)</option>
                    <option value="OPD HEAD NECK BREAST(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°)">OPD HEAD NECK BREAST(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°)</option>
                    <option value="OPD MEDICINE(‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏£‡∏£‡∏°)">OPD MEDICINE(‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏£‡∏£‡∏°)</option>
                    <option value="OPD NEURO (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏°‡∏≠‡∏á)">OPD NEURO (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏°‡∏≠‡∏á)</option>
                    <option value="OPD OB/GYN(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ç‡∏¥‡∏á)">OPD OB/GYN(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ç‡∏¥‡∏á)</option>
                    <option value="OPD PEDIATRIC( ‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡πá‡∏Å)">OPD PEDIATRIC( ‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡πá‡∏Å)</option>
                    <option value="OPD SURGERY(‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°)">OPD SURGERY(‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°)</option>
                    <option value="OPD UROLOGY (‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞)">OPD UROLOGY (‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞)</option>
                    <option value="OPERATING ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î)">OPERATING ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î)</option>
                    <option value="PHARMARCY(‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤)">PHARMARCY(‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤)</option>
                    <option value="PHYATHAI BEAUTY CENTER (PBC ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°)">PHYATHAI BEAUTY CENTER (PBC ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°)</option>
                    <option value="PHYSICAL THERAPY( ‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û)">PHYSICAL THERAPY( ‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û)</option>
                    <option value="PICU">PICU</option>
                    <option value="PWA LIFE CENTER">PWA LIFE CENTER</option>
                    <option value="PWA ‡∏ä‡∏∞‡∏•‡∏≠‡∏ß‡∏±‡∏¢">PWA ‡∏ä‡∏∞‡∏•‡∏≠‡∏ß‡∏±‡∏¢</option>
                    <option value="VEHICLE">VEHICLE</option>
                    <option value="WARD 10">WARD 10</option>
                    <option value="WARD 11">WARD 11</option>
                    <option value="WARD 12">WARD 12</option>
                    <option value="WARD 14">WARD 14</option>
                    <option value="WARD 15">WARD 15</option>
                    <option value="WARD 17">WARD 17</option>
                    <option value="WARD 7">WARD 7</option>
                    <option value="WARD 8">WARD 8</option>
                    <option value="WARD 9">WARD 9</option>
                    <option value="WAREHOUSE">WAREHOUSE</option>
                    <option value="X-RAY">X-RAY</option>
                    <option value="‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á">‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á</option>
                </select>
            </div>
            <div class="col-12 mt-3">
                <input type="text" id="remark" class="form-control" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á/‡πÄ‡∏•‡∏Ç‡∏´‡πâ‡∏≠‡∏á/‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á/‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-12 flex-fill mb-2">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="isDemo">
                    <label class="form-check-label" for="isDemo">
                        Demo
                    </label>
                </div>
            </div>
            <div class="col-auto flex-fill mb-2">
                <input type="text" id="add-id" name="add-id" class="form-control text-center text-bg-warning shadow-none" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™">
            </div>
            <div class="col-auto text-center mb-2">
                <button class="btn btn-primary" id="add-btn">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏´‡∏±‡∏™</button>
            </div>
        </div>
        <section id="id-sec">

        </section>
    </div> -->
    <div class="container">
        <div class="row justify-content-center align-items-end mt-3">
            <div class="col-auto flex-fill mb-2 text-center">
                <label for="add-id">‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                <input type="search" id="add-id" name="add-id"
                    class="form-control text-center text-bg-warning shadow-none" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™">
            </div>
            <div class="col-auto flex-fill text-center mb-2 d-none">
                <label for="site">‡πÅ‡∏ú‡∏ô‡∏Å</label>
                <select class="form-select" id="site">
                    <option value="" selected disabled>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site</option>
                    <option value="PYT1">PHYATHAI 1</option>
                    <option value="PYT2">PHYATHAI 2</option>
                    <option value="PYT3">PHYATHAI 3</option>
                    <option value="PTP">PHYATHAI PHAHOLYOTHIN</option>
                    <option value="PTN">PHYATHAI NAWAMIN</option>
                </select>
            </div>
            <div class="col-auto text-center mb-2">
                <button class="btn btn-success" id="add-btn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
            </div>
        </div>
        <div class="table-responsive" id="dept_table"></div>
    </div>
    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
    <script>
        // VConsole will be exported to `window.VConsole` by default.
        // var vConsole = new window.VConsole();
    </script>
    <script>
        var script_url = 'https://script.google.com/macros/s/AKfycbx_g-xZYndPu9IzaYITUdHQ5ckjxX8dGxkB6qkhVfQxMrmAN7PfN9X7ENbVhXCgEWxCEg/exec'
    </script>
    <script>
        var client
        $(document).ready(() => {
            $('#site').select2({
                theme: 'bootstrap-5',
                templateResult: (opt) => {
                    console.log("üöÄ !! opt:", opt)
                    if (!opt.id) {
                        return opt.text
                    }
                    var $opt = $(
                        '<span class="d-flex align-items-center p-2"><img src="./' + opt.id.toLowerCase() + '-logo.jpg" height="40px" class="img-flag" /><span class="text-center w-100">' + opt.text + '</span></span>'
                    );
                    return $opt;
                }, templateSelection: function (data) {
                   client = data.id
                   console.log("üöÄ !! client:", client)
                    return data.text;
                }
            });
            $("#site .select2-results").css("max-height", "600px");
            $.LoadingOverlay("show")
            $('#add-id').on('keyup', (e) => {
                if (e.keyCode == 13) {
                    searchLocationData()
                }
            })
            $('#add-btn').click(() => searchLocationData())
            $('#add-id').mask('00000')

            liff.init({
                // liffId: '1655873446-3xe866Ql', // test id
                liffId: '1657539607-ovPRPQe6', // prod id
                withLoginOnExternalBrowser: true
            })
            liff.ready.then(async () => {
                profile = await liff.getProfile()
                $('#profile').attr('src', profile.pictureUrl)
                $('#displayName').text(profile.displayName)
                const defaultProject = firebase.initializeApp(await $.getJSON('./service-account.json'));
                firestore = defaultProject.firestore();
                auth = defaultProject.auth();
                if (!auth.currentUser) {
                    // await getAuth()
                    await getAuth(await liff.getDecodedIDToken().sub)
                }
                $.LoadingOverlay('hide', true)
                if (!await checkClient()) {
                    Swal.fire({
                        icon: 'info',
                        title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô',
                        html: `<div class="container-fluid">
                                    <div class="row">
                                        <div class="col-12">
                                            <select class="form-select" id="client">
                                                <option value="" selected disabled>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site</option>
                                                <option value="PYT1">PHYATHAI 1</option>
                                                <option value="PYT2">PHYATHAI 2</option>
                                                <option value="PYT3">PHYATHAI 3</option>    
                                                <option value="PTP">PHYATHAI PHAHOLYOTHIN</option>    
                                                <option value="PTN">PHYATHAI NAWAMIN</option>    
                                            </select>    
                                        </div>
                                    </div>
                                </div>`,
                        didOpen: () => {
                            $('#client').select2({
                                theme: 'bootstrap-5',
                                templateResult: (opt) => {
                                    console.log("üöÄ !! opt:", opt)
                                    if (!opt.id) {
                                        return opt.text
                                    }
                                    var $opt = $(
                                        '<span class="d-flex align-items-center p-2"><img src="./' + opt.id.toLowerCase() + '-logo.jpg" height="40px" class="img-flag" /><span class="text-center w-100">' + opt.text + '</span></span>'
                                    );
                                    return $opt;
                                }
                            });
                            $("#client .select2-results").css("max-height", "600px");
                        },
                        preConfirm: () => {
                            if ($('#client').val() == '' || !$('#client').val()) {
                                Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site')
                            }
                            return $('#client').val()
                        },
                        allowOutsideClick: false,
                        showCancelButton: false,
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                    }).then(res => {
                        if (res.isConfirmed) {
                            cl = res.value
                            firestore.collection('users').doc(liff.getDecodedIDToken().sub).set({
                                client: cl
                            }).then(() => {
                                client = cl
                                if (client.toLowerCase() == 'all') {
                                    $('#add-id').parent().removeClass('col-auto').addClass('col-md-4')
                                    $('#site').parent().removeClass('d-none')
                                }
                                return Swal.fire({
                                    icon: 'success',
                                    title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                                    text: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Site ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                                    showConfirmButton: false,
                                    timer: 1500,
                                })
                            })
                        }
                    })
                }
            })
        })

        // //setup before functions
        // let typingTimer;                //timer identifier
        // let doneTypingInterval = 500;  //time in ms, 5 seconds for example
        // let $input = $('#add-id');

        // //on keyup, start the countdown
        // $input.on('keyup', function () {
        //     clearTimeout(typingTimer);
        //     typingTimer = setTimeout(doneTyping, doneTypingInterval);
        // });

        // //on keydown, clear the countdown 
        // $input.on('keydown', function () {
        //     clearTimeout(typingTimer);
        // });

        // //user is "finished typing," do something
        // function doneTyping() {
        //     searchLocationData()
        // }

        async function checkClient() {
            let user = await firestore.collection('users').doc(liff.getDecodedIDToken().sub).get()
            console.log("üöÄ !! user:", user.data())
            if (user.exists) {
                client = user.data().client
                if (client.toLowerCase() == 'all') {
                    $('#add-id').parent().removeClass('col-auto').addClass('col-md-4')
                    $('#site').parent().removeClass('d-none')
                }
                return true
            } else {
                return false
            }
        }

        function searchLocationData() {
            $('#dept_table').slideUp(200)
            let id = $('#add-id').val()
            if (id.length == 0) {
                return Swal.fire({
                    icon: 'error',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á',
                    showConfirmButton: false,
                    timer: 1500
                })
            }
            if (id.length < 4) {
                return Swal.fire({
                    icon: 'error',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏•‡∏±‡∏Å',
                    showConfirmButton: false,
                    timer: 1500
                })
            }
            if(client.toLowerCase() == 'all' && $('#site').val() == null) {
                return Swal.fire({
                    icon: 'error',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Site',
                    showConfirmButton: false,
                    timer: 1500
                })
            }
            $.LoadingOverlay("show")
            // replace not number character
            id = id.replace(/\D/g, '')
            let queryArr = []

            queryArr.push(client + '_' + (('00000' + id).slice(-5)))
            queryArr.push(client + 'D_' + (('00000' + id).slice(-5)))
            queryArr.push('DEMO_' + (('000000' + id).slice(-6)))
            queryArr.push(client + (('00000' + id).slice(-5)))
            firestore.collectionGroup('location').where("code", 'in', queryArr).limit(100).get().then(doc => {
                console.log("üöÄ !! doc:", doc)
                if (doc.empty) {
                    $.LoadingOverlay("hide", true)
                    return Swal.fire({
                        icon: 'error',
                        title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                        text: '‡∏£‡∏´‡∏±‡∏™ ' + $('#add-id').val(),
                        confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                    })
                }
                let data = []
                doc.forEach(d => {
                    data.push(d.data())
                })
                console.log(data);
                createTable(data)
            })
            // $.ajax({
            //     url: script_url,
            //     method: "GET",
            //     dataType: "json",
            //     data: {
            //         opt: 'searchlocationdata',
            //         id: id
            //     },
            //     success: function (response) {
            //         $.LoadingOverlay("hide")
            //         console.log(response)
            //         if (response.status == 'error') {
            //             return Swal.fire({
            //                 icon: 'error',
            //                 title: response.message,
            //                 showConfirmButton: false,
            //                 timer: 1500
            //             })
            //         }
            //         createTable(response.data)

            //     }
            // });
            // createTable()
        }

        function createTable(data) {
            if (data.length <= 0) {

                return Swal.fire({
                    icon: 'error',
                    title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                    text: '‡∏£‡∏´‡∏±‡∏™ ' + $('#add-id').val(),
                    confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                })
            }
            let table = $(`<table class="table table-bordered table-striped table-hover"></table>`)
            table.attr('id', 'data_table')
            let thead = $(`<thead></thead>`).addClass('text-bg-primary')
            let tbody = $(`<tbody></tbody>`)
            $(thead).append($(`<tr></tr>`).html(`<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡πÅ‡∏ú‡∏ô‡∏Å</th><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>`).addClass('text-center'))
            $(thead).append($(`<tr class="text-bg-success"></tr>`).append($('<th colspan="4"</th>').text(`‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™ ${$('#add-id').val()}`))).addClass('text-center')

            $(table).append(thead)
            $(table).append(tbody)
            $('#data_table').remove()
            $('#dept_table').append(table)
            console.log("üöÄ ~ data", data)
            data.forEach((row, i) => {
                if (i == 0) {
                    row.dept = '<i class="bi bi-geo-alt-fill fs-3 text-danger"></i> &nbsp;&nbsp;' + row.dept

                    let date = new Date(row.timestamp.toMillis())
                    let tr = $(`<tr></tr>`).html(`<td>${date.toLocaleDateString('th-TH', {
                        year: 'numeric',
                        month: 'numeric',
                        day: 'numeric',
                    })}</td><td>${row.dept}</td><td>${row.remark == "" ? '---' : row.remark}</td><td>${row.line}</td>`)
                    $(tbody).append(tr)
                }
            })
            // format first row of tbody

            // add blink border to first row of tbody
            $(tbody).find('tr:first').addClass('blink-border')

            // add pointer icon to 2nd column of first row of tbody
            $('#dept_table').slideDown(200)
            $.LoadingOverlay("hide")
        }
    </script>

    <script>
        var depts = [
            "FL.19 OPD UROLOGY (‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞)",
            "FL.19 DIABETIC&METABOLIC(‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô)",
            "FL.18 OPD HEAD NECK BREAST(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°)",
            "FL.18 CHECK-UP (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û)",
            "FL.17 WARD 17",
            "FL.17 HOPD CENTER (‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á)",
            "FL.16 PHYSICAL THERAPY( ‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û)",
            "FL.15 WARD 15",
            "FL.14 WARD 14",
            "FL.14 PWA ‡∏ä‡∏∞‡∏•‡∏≠‡∏ß‡∏±‡∏¢",
            "FL.14 PWA LIFE CENTER",
            "FL.14 PHYATHAI BEAUTY CENTER (PBC ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°)",
            "FL.14 OBSERVE(‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£)",
            "FL.12 WARD 12",
            "FL.11 WARD 11",
            "FL.10 WARD 10",
            "FL.09 WARD 9",
            "FL.08 WARD 8",
            "FL.07 WARD 7",
            "FL.06-D WAREHOUSE",
            "FL.06-D MAID",
            "FL.06 NURSERY(‡πÄ‡∏î‡πá‡∏Å‡∏≠‡πà‡∏≠‡∏ô)",
            "FL.06 LABOR ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏•‡∏≠‡∏î)",
            "FL.06 ART-LAB (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏ö‡∏∏‡∏ï‡∏£‡∏¢‡∏≤‡∏Å)",
            "FL.05 NURSING DEPARTMENT",
            "FL.05 MARKETING",
            "FL.05 INFECTION CONTROL ( IC)",
            "FL.05 CORPORATE CUSTOMER SERVICE",
            "FL.04 OPD PEDIATRIC( ‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡πá‡∏Å)",
            "FL.04 LABORATORY",
            "FL.04 EENT( ‡∏´‡∏π‡∏ï‡∏≤‡∏Ñ‡∏≠‡∏à‡∏°‡∏π‡∏Å)",
            "FL.03 PICU",
            "FL.03 OPERATING ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î)",
            "FL.03 INTENSIVE CARE UNIT(‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏ô‡∏±‡∏Å)",
            "FL.03 HEMODIALYSIS (‡πÑ‡∏ï‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)",
            "FL.03 CSSD (‡∏à‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏≤‡∏á)",
            "FL.03 CATH-LAB",
            "FL.03 BME-PYT3",
            "FL.03 ANESTHESIA (‡∏ß‡∏¥‡∏™‡∏±‡∏ç‡∏ç‡∏µ)",
            "FL.02 OPD OB/GYN(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ç‡∏¥‡∏á)",
            "FL.02 OPD NEURO (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏°‡∏≠‡∏á)",
            "FL.02 OPD CARDIO(‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏´‡∏±‡∏ß‡πÉ‡∏à)",
            "FL.02 GASTROINTESTINAL LABORATORY(GI)",
            "FL.02 DENTAL (‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°)",
            "FL.01 ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á",
            "FL.01 X-RAY",
            "FL.01 VEHICLE",
            "FL.01 PHARMARCY(‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤)",
            "FL.01 OPD SURGERY(‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°)",
            "FL.01 OPD MEDICINE(‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏£‡∏£‡∏°)",
            "FL.01 OPD COUNTER NURSE (CN ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á)",
            "FL.01 EMERGENCY( ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)"
        ]
    </script>
    <script>
        var firestore, auth
        async function getAuth(uid = 'test') {
            let email = uid + '@minion-location.com'
            let password = 'minion-location'
            await auth.signInWithEmailAndPassword(email, password).then(function (user) {
                console.log('sign in successful')
            }).catch(async function (error) {
                var errorCode = error.code;
                var errorMessage = error.message;
                var credential = error.credential;
                console.log(errorCode)
                console.log(errorMessage)
                console.log(credential)
                await auth.createUserWithEmailAndPassword(email, password).then(function (user) {
                    console.log('sign up successful')
                }).catch(function (error) {
                    // Handle Errors here.
                    var errorCode = error.code;
                    var errorMessage = error.message;
                    // The email of the user's account used.
                    var email = error.email;
                    // The firebase.auth.AuthCredential type that was used.
                    var credential = error.credential;
                    // ...
                    console.log(errorCode)
                    console.log(errorMessage)
                    console.log(email)
                    console.log(credential)
                });
            });
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"
        integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</body>

</html>