<!DOCTYPE html>
<html lang="en">

<head>
    <!-- dont keep cache -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base target="_top">
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/confirmDate/confirmDate.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://unpkg.com/nprogress@0.2.0/nprogress.css">
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/@pdf-lib/fontkit@1.1.1/dist/fontkit.umd.min.js"></script>
    <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" />
    <link rel="stylesheet"
        href="https://fastly.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />
    <link href="https://cdn.datatables.net/v/bs5/dt-2.3.4/datatables.min.css" rel="stylesheet"
        integrity="sha384-i0jVPhw/X00l5EPvMOBv0lcGYXlSQGOqNYpMK/406rxta9oBump0IZJIHzvtf3+H" crossorigin="anonymous">

    <script src="https://cdn.datatables.net/v/bs5/dt-2.3.4/datatables.min.js"
        integrity="sha384-jVoHjtunWKmr2zpSki5PSXfFYRsTQQm1uk4wpf45zuYxast668XkB2fJL8PjloNc"
        crossorigin="anonymous"></script>

    <style>
        :root {
            --primary-color: #8165b2;
            --primary-dark: #6b4fa3;
            --primary-light: #9a82c4;
            --secondary-color: #10b981;
            --secondary-dark: #059669;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --bg-light: #f9fafb;
            --border-color: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans Thai', sans-serif;
            background: linear-gradient(135deg, #8165b2 0%, #d8c2ff 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container-fluid {
            position: relative;
            z-index: 1;
        }

        #sticker {
            width: 100%;
            height: 100%;
        }

        .nsmart-img {
            cursor: grab;
        }

        .nsmart-img:active {
            cursor: grabbing;
        }

        /* Modern Header Styles */
        header .navbar {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
            box-shadow: var(--shadow-lg);
            padding: 15px 20px;
            border-radius: 0 0 20px 20px;
        }

        header .container-fluid.d-flex {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.6s ease;
        }

        header .h1 {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Form Container Styles */
        #myForm section {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            padding: 30px;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            animation: slideUp 0.6s ease;
        }

        #myForm section:hover {
            box-shadow: var(--shadow-xl);
        }

        /* Section Headers */
        .col-12.d-flex.align-items-center.mt-3 {
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 20px;
        }

        .col-12.d-flex.align-items-center.mt-3 h4 {
            color: var(--text-dark);
            font-weight: 600;
        }

        /* Input Styles */
        .form-control,
        .form-select,
        textarea.form-control {
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 12px 16px;
            font-size: 14px;
            transition: all 0.3s ease;
            background-color: #fff;
            resize: vertical;
        }

        .form-control:focus,
        .form-select:focus,
        textarea.form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(129, 101, 178, 0.1);
            transform: translateY(-2px);
        }

        .form-control:hover,
        .form-select:hover,
        textarea.form-control:hover {
            border-color: var(--primary-light);
        }

        /* Phone input specific styling */
        input[type="tel"] {
            font-family: monospace, 'Noto Sans Thai', sans-serif;
        }

        label {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Table Styles */
        .table-responsive {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        #table-equipment {
            margin-bottom: 0;
        }

        #table-equipment thead {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        #table-equipment thead th {
            background: black;
            color: white;
            padding: 12px 16px;
            text-align: center;
            font-weight: 500;
            font-size: 13px;
            border: none;
        }

        #table-equipment tbody tr {
            transition: background-color 0.2s ease;
        }

        #table-equipment tbody tr:hover {
            background-color: #f9fafb;
        }

        #table-equipment tbody td {
            padding: 12px 16px;
            vertical-align: middle;
            font-size: 14px;
            border-bottom: 1px solid #f3f4f6;
        }

        /* Button Styles */
        .btn {
            border-radius: 10px;
            padding: 10px 24px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-dark {
            background: linear-gradient(135deg, var(--text-dark) 0%, #374151 100%);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-dark:hover {
            box-shadow: var(--shadow-lg);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color) 0%, #d97706 100%);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-warning:hover {
            box-shadow: var(--shadow-lg);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #dc2626 100%);
            color: white;
        }

        .btn-danger:hover {
            box-shadow: 0 4px 8px rgba(239, 68, 68, 0.4);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        button[type="submit"] {
            background: linear-gradient(135deg, var(--warning-color) 0%, #d97706 100%);
            color: white;
            padding: 14px 40px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
        }

        button[type="submit"]:hover {
            box-shadow: var(--shadow-xl);
        }

        /* Offcanvas Styles */
        .offcanvas-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
        }

        .offcanvas-body {
            background: var(--bg-light);
        }

        .offcanvas-body .form-control,
        .offcanvas-body textarea {
            border: 2px solid var(--border-color);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .offcanvas-body .form-control:focus,
        .offcanvas-body textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(129, 101, 178, 0.1);
        }

        /* Download Link */
        #a-download {
            color: var(--primary-color);
            text-decoration: none;
            padding: 10px 20px;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            transition: all 0.3s ease;
            display: inline-block;
        }

        #a-download:hover {
            background: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-md);
        }

        /* PDF iframe */
        #pdf {
            border-radius: 16px;
            box-shadow: var(--shadow-xl);
            border: none;
        }

        /* Alert Styles */
        .alert {
            border-radius: 10px;
            border: none;
        }

        .alert-info {
            background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
            color: var(--text-dark);
        }

        .alert-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fef9e7 100%);
            color: var(--text-dark);
        }

        /* Badge Styles */
        .badge {
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 13px;
        }

        .bg-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
        }

        /* Stats Card */
        .card {
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        /* Empty State */
        #empty-state {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Animations */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Required Field Indicator */
        .text-danger {
            color: var(--danger-color);
        }

        /* Small helper text */
        small.text-muted {
            color: var(--text-light);
            font-size: 12px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            #myForm section {
                padding: 20px;
                margin-bottom: 15px;
            }

            header .container-fluid.d-flex {
                padding: 20px;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Signature Section Styles */
        .signature-box-wrapper {
            margin-bottom: 20px;
        }

        .signature-display-box {
            border: 2px dashed #ddd;
            border-radius: 8px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            position: relative;
            overflow: hidden;
        }

        .signature-display-box:hover {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, #fff 0%, rgba(106, 27, 154, 0.05) 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(106, 27, 154, 0.15);
        }

        .signature-display-box.has-signature {
            border: 2px solid var(--success-color);
            background: linear-gradient(135deg, #fff 0%, rgba(40, 167, 69, 0.05) 100%);
        }

        .signature-placeholder {
            text-align: center;
            color: #999;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .signature-placeholder i {
            font-size: 24px;
            color: var(--primary-color);
        }

        .signature-placeholder span {
            font-size: 14px;
            font-weight: 500;
        }

        .signature-info {
            text-align: center;
        }

        .signature-preview-canvas {
            max-width: 100%;
            max-height: 100%;
            border-radius: 6px;
        }

        /* Signature Modal Styles */
        .signature-modal .modal-body {
            padding: 30px;
        }

        .signature-canvas-container {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 100%;
        }

        .signature-canvas {
            border-radius: 6px;
            cursor: crosshair;
            max-width: 100%;
            max-height: 300px;
            width: 100%;
            height: auto;
            display: block;
        }

        .signature-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .signature-title {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 15px;
        }

        .signature-instruction {
            background: linear-gradient(135deg, rgba(106, 27, 154, 0.1) 0%, rgba(106, 27, 154, 0.05) 100%);
            border: 1px solid rgba(106, 27, 154, 0.2);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .signature-instruction i {
            color: var(--primary-color);
            margin-right: 8px;
        }
    </style>
    <title>RR Form</title>
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="container-fluid">
                <div class="d-flex align-items-center gap-2">
                    <img width="30" height="30" src="./icons/outsource-icon.png" alt="outsource" />
                    <span class="text-white fw-bold">บันทึกรายการส่งซ่อมภายนอก</span>
                </div>
                <button class="btn btn-sm btn-warning d-none" id="install-btn">
                    <i class="bi bi-file-arrow-down-fill"></i>
                    Install
                </button>
            </div>
        </nav>
        <div class="container-fluid d-flex flex-column align-items-center justify-content-center w-100 mt-4">
            <div class="col-auto">
                <img width="80" src="./icons/outsource-icon.png" alt="outsource" />
            </div>

            <div class="col text-center">
                <h1 class="h1 fw-bold">บันทึกรายการส่งซ่อมภายนอก</h1>
                <p class="text-muted mt-2">Outsource Repair Record Form</p>
            </div>
        </div>
    </header>
    <main>
        <div class="container-fluid m-0 p-0">
            <form id="myForm" class="mt-3 mb-5">
                <section>
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center mt-3">
                            <i class="fas fa-clipboard-list" style="color: var(--primary-color); font-size: 24px;"></i>
                            <h4 class="fw-bold ms-2 mb-0">ข้อมูลการส่งซ่อม</h4>
                        </div>
                        <div class="col-12 mt-3">
                            <label for="vender-name">
                                <i class="fas fa-truck-medical"></i>
                                บริษัทรับซ่อม / Repair Vendor
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" name="vender-name" id="vender-name" class="form-control"
                                placeholder="กรอกชื่อบริษัทที่จะส่งซ่อม" list="venderList" required />
                            <datalist id="venderList">
                                <option>3G Med Supplies Co.,Ltd.</option>
                                <option>3M Health Care</option>
                                <option>3M. Thailand Co.,Ltd.</option>
                                <option>A.P.Tac (Thailand) Co.,Ltd.</option>
                                <option>Abbott Laboratories Co., Ltd.</option>
                                <option>Abbott Medical (Thailand) Co., Ltd.</option>
                                <option>Accord Corporation Limited</option>
                                <option>Acteon (Thailand) Ltd.</option>
                                <option>Advance Medical Esthetics (Thailand) Co.,Ltd.</option>
                                <option>AEC Healthcare Co.,Ltd.</option>
                                <option>Aesthetics By Ampex Co.,Ltd.</option>
                                <option>Afta Service and Supply Co.,Ltd.</option>
                                <option>Air Liquide (Thailand) Co.,Ltd.</option>
                                <option>Alcon Laboratories (Thailand) Limited</option>
                                <option>Align Technology (Thailand) Co.,Ltd.</option>
                                <option>Allwell Life Co.,Ltd</option>
                                <option>Asia Health Plus Co.,Ltd.</option>
                                <option>Asras Medical Co.,Ltd.</option>
                                <option>Astraco Medical Networks ltd.</option>
                                <option>Audimed Co., Ltd.</option>
                                <option>B Braun</option>
                                <option>Bangkok Unitrade Co.,Ltd.</option>
                                <option>Bausch &amp; Lomb (Thailand) LTD.</option>
                                <option>Bawmed U.K (Asia) Co.,Ltd.</option>
                                <option>Baxter Healthcare (Thailand) Co., Ltd.</option>
                                <option>Beamed Co., Ltd.</option>
                                <option>Becton dickinson (thailand) Ltd.</option>
                                <option>Bemepro Co., Ltd.</option>
                                <option>Berlin Germany Import </option>
                                <option>Better Life Med Care</option>
                                <option>Better Medical Care Co.,Ltd.</option>
                                <option>Bio active Co.,Ltd.</option>
                                <option>Bio Plus Medical Company Limited</option>
                                <option>Bioactive Inter Co.,Ltd.</option>
                                <option>Biosensors Interventional Technologies Pte Ltd</option>
                                <option>BJH Healthcare Co., Ltd.</option>
                                <option>BJH Medical</option>
                                <option>Boston Scientrfic</option>
                                <option>BTL Medical Technologies Ltd.</option>
                                <option>C.R.M. Healthcare Co.,Ltd.</option>
                                <option>Cardinal Health (Thailand) Co.,Ltd.</option>
                                <option>CardioScan (Thailand) Co., Ltd.</option>
                                <option>Carestream Health (Thailand) Co., Ltd.</option>
                                <option>Carl Zeiss Co., Ltd.</option>
                                <option>Chumroen Medical Products Co.,Ltd.</option>
                                <option>Circlife Co,Ltd.</option>
                                <option>CMC Biotech co.,ltd.</option>
                                <option>Connect Diagnostics Co.,Ltd.</option>
                                <option>Cook Medical (Thailand) Co., Ltd.</option>
                                <option>Cosmed Aesthetic Co., Ltd.</option>
                                <option>Covidien (Thailand) Ltd.</option>
                                <option>Crystal Calibration Sale And Service</option>
                                <option>D MED Hearing center Co.,Ltd.</option>
                                <option>DDS Innotech Co., Ltd.</option>
                                <option>Dental Vision (Thailand) Co.Ltd</option>
                                <option>Dent-Mate Co.,Ltd.</option>
                                <option>Dentsply Sirona(Thailand) Co.,Ltd.</option>
                                <option>Device Innovation Co.,Ltd.</option>
                                <option>Dextrous Engineering Co.,Ltd.</option>
                                <option>Diamond Medical Co., Ltd.</option>
                                <option>Dkk Device Co., Ltd.</option>
                                <option>DKSH</option>
                                <option>Doctor Calibration Co., Ltd.</option>
                                <option>Double U Tech Co.,Ltd.</option>
                                <option>Drager Medical (Thailand) Company Limited</option>
                                <option>DS All Co.,Ltd.</option>
                                <option>E for L Aim Public Company Limited</option>
                                <option>Earth Line Co.,LTD&nbsp;</option>
                                <option>Easmed Co.,Ltd.</option>
                                <option>Econtech Supply Co., Ltd.</option>
                                <option>Edwards Lifesciences(Thailand) Ltd.</option>
                                <option>Eminence International limites</option>
                                <option>Empire Scientifique Co.,Ltd.</option>
                                <option>Endomed (1990) Co,.Ltd</option>
                                <option>Endomed Service Co., Ltd.</option>
                                <option>Endoscope &amp; Service Ltd., Part.</option>
                                <option>Enovations Co.,ltd</option>
                                <option>Enraf-Nonius Medical Equipment Co.,Ltd.</option>
                                <option>Equip Healthcare Co., Ltd</option>
                                <option>EQUIP HEALTHCARE CO.,LTD</option>
                                <option>Erawan Hi-Tech Co.,Ltd.</option>
                                <option>Esco Lifesciences (Thailand) Co., Ltd.</option>
                                <option>Euroscan Co.,Ltd.</option>
                                <option>EVA Genesis Co,Ltd.</option>
                                <option>Expert Technology Development Co.,Ltd.</option>
                                <option>Famme Works Co.,Ltd.</option>
                                <option>Filtech Enterprise 1994 Public Co.,Ltd.</option>
                                <option>Fresenius Medical Care (Thailand) Ltd.</option>
                                <option>Fujifilm (Thailand) Co., Ltd.</option>
                                <option>Future Medical Supply Co., Ltd.</option>
                                <option>Gateway Health Co.,Ltd.</option>
                                <option>GE Healthcare</option>
                                <option>Getinge (Thailand) Co.,ltd</option>
                                <option>Getz Healthcare (Thailand) Co.,Ltd.</option>
                                <option>Gibthai Co.,Ltd.</option>
                                <option>Global Healthy Care Co.,Ltd.</option>
                                <option>Grand Medical Co.,Ltd.</option>
                                <option>Grandee International Co.,Ltd.</option>
                                <option>Growth Supply Medical Co., Ltd.</option>
                                <option>Hairmax (Thailand) Co., Ltd.</option>
                                <option>Hausen Bernstein Co., Ltd.</option>
                                <option>Histocenter (Thailand) Co.,Ltd.</option>
                                <option>Hollywood International Co.,Ltd.</option>
                                <option>Hospitop Equipment Company Limited</option>
                                <option>HYPERBARIC TECHNOLOGIES CO.,LTD.</option>
                                <option>Ideewell Co.,Ltd.</option>
                                <option>Idenmed Co., Ltd</option>
                                <option>IDS MED Systems (Thailand) </option>
                                <option>InBody (Thailand) Co.,Ltd.</option>
                                <option>Infinite Med Co.,Ltd.</option>
                                <option>Ingenious Technology Co., Ltd.</option>
                                <option>Innotech Surgical Co.,Ltd.</option>
                                <option>Innovative Imaging Systems Co.,Ltd.</option>
                                <option>Integrated Medical Service Co.,Ltd.</option>
                                <option>Inter Medical Co.,Ltd.</option>
                                <option>Interpharma Medtech Co., Ltd.</option>
                                <option>Intime Medical Co., Ltd.</option>
                                <option>JF Advance med co.,ltd</option>
                                <option>Johnson &amp; Johnson (Thailand) Ltd. &nbsp;</option>
                                <option>JPP CARE CO.,LTD</option>
                                <option>JS Unitech Co.,Ltd.</option>
                                <option>K.Performance Co.,Ltd</option>
                                <option>KAINATIC MMS Enterprise Co.,LTD</option>
                                <option>Kosin Medical Supply</option>
                                <option>KP5</option>
                                <option>Lab Leader Co.,Ltd.</option>
                                <option>LABIVF (Thailand) Co.,Ltd.</option>
                                <option>Labotron Co., Ltd.</option>
                                <option>Laser Engineer Co.,Ltd.</option>
                                <option>Lasermed Co., Ltd.</option>
                                <option>Linde (Thailand) Public Company Limited</option>
                                <option>Livanova (Thailand) co. ltd</option>
                                <option>LivaNova (Thailand) Co.,Ltd.</option>
                                <option>Louis T. leonowens (Thailand) ltd.</option>
                                <option>Luck Asia Intertrade Co.,Ltd</option>
                                <option>Lundal (Thailand) Co.,Ltd.</option>
                                <option>M D C (Thailand) Co.,Ltd.</option>
                                <option>M.I.Calibration System Co.,Ltd.</option>
                                <option>Maquet (Thailand) Co.,Ltd.</option>
                                <option>Marathon (Thailand) Co.,Ltd.</option>
                                <option>Maroongroge Co., Ltd</option>
                                <option>Martha Group Co.,Ltd.</option>
                                <option>Matsunaga (Thailand) Co.,Ltd.</option>
                                <option>Max Power System Co.,Ltd.</option>
                                <option>MD Healthcare Company Limited (Thailand)</option>
                                <option>Medeze NK Co., Ltd.</option>
                                <option>Medfocus.Co.,Ltd.</option>
                                <option>Medi Hub Asia Co.,Ltd.</option>
                                <option>Medica Healthcare Co.,Ltd.</option>
                                <option>Medical Appliance Center Co.,Ltd.</option>
                                <option>Medical Intensive Care Co.,Ltd.</option>
                                <option>Medical Solution Co., Ltd</option>
                                <option>Medicare (thailand) Co.,Ltd.</option>
                                <option>Medicool Co.,Ltd.</option>
                                <option>Mediplex (Thailand) Co., Ltd.</option>
                                <option>Meditime Co., Ltd.</option>
                                <option>Meditop Co., Ltd.</option>
                                <option>Med-one Co.,Ltd.</option>
                                <option>Medtech Asia Co., Ltd.</option>
                                <option>Medtech Medical (Thailand) Co.,Ltd.</option>
                                <option>Medtronic (Thailand) limited</option>
                                <option>Metta Medtech Co.,Ltd.</option>
                                <option>Mind Medical Care Co.,Ltd.</option>
                                <option>Modem Brands Co.,Ltd</option>
                                <option>Modernform Health&amp;Care</option>
                                <option>MP Group (Thailand) Co.,Ltd.</option>
                                <option>Muffin Co.,Ltd.</option>
                                <option>N Health</option>
                                <option>Namwiwat Engineering (1992) Co., Ltd.</option>
                                <option>Nephrocare (Thailand) Co., Ltd.</option>
                                <option>New Eye Co.,Ltd.</option>
                                <option>New Lifemed Co.,Ltd.</option>
                                <option>Nikkiso Medical </option>
                                <option>Noble Med Co.,Ltd.</option>
                                <option>Novatec Healthcare Co.,Ltd</option>
                                <option>Novatec Healthcare Co.,Ltd.</option>
                                <option>NSP Solution Co.,Ltd.</option>
                                <option>Num Tech Med Co.,Ltd</option>
                                <option>Olympus Thailand</option>
                                <option>Omnimed Co.,Ltd</option>
                                <option>Originator Co.,Ltd.</option>
                                <option>Otto Bock South East Asia Co., Ltd.</option>
                                <option>P.Diagnostics Co.,Ltd.</option>
                                <option>P.P.A. Medical Group Co.,Ltd.</option>
                                <option>Paramount Bed (Thailand) Co., Ltd.</option>
                                <option>PCL Holding Co.,Ltd.</option>
                                <option>Peakmed Co., Ltd.</option>
                                <option>Phar Trillion Co., Ltd.</option>
                                <option>Philips (Thailand) ltd.</option>
                                <option>Phoenix Excel Co.,Ltd.</option>
                                <option>Photo Bio Care Co.,Ltd.</option>
                                <option>Pisces medical Co., Ltd.</option>
                                <option>POF Eternity Co.,Ltd</option>
                                <option>POF Technology Co.,Ltd.</option>
                                <option>Power Stainless Steel Co., Ltd.</option>
                                <option>PP Systems Co., Ltd.</option>
                                <option>Prapatsorn Engineering Supply Co.,Ltd</option>
                                <option>Premiers Medical Co.,Ltd.</option>
                                <option>Prime Medical Co.,Ltd</option>
                                <option>PRO OPTIK CO.,LTD.</option>
                                <option>PSE Medical Co.,Ltd.</option>
                                <option>Quantum Healthcare (Thailand) Co., Ltd.</option>
                                <option>R.X. Co.,Ltd</option>
                                <option>R.X. Co.,Ltd.</option>
                                <option>Rapport Co., Ltd</option>
                                <option>Rehab Medical Co.,Ltd.</option>
                                <option>Ricco service&amp;Supply Co.,Ltd.</option>
                                <option>Roche Diagnnostics (Thailand) Ltd.</option>
                                <option>S.D.Tantavade (1988) Co.,Ltd.</option>
                                <option>S.K. Medical and Engineering Co.,Ltd.</option>
                                <option>S.M.J Inter Product Co.,Ltd.</option>
                                <option>Saintmed Co.,Ltd.</option>
                                <option>Salyaveth Co., Ltd.</option>
                                <option>Science Engineer International Co., Ltd.</option>
                                <option>Sei Medical Public Company Limited</option>
                                <option>Siam Hearing Co.,Ltd.</option>
                                <option>Siam Hospital Supply Co., Ltd.</option>
                                <option>Siam Inter National Medical Equipment Co.,Ltd.</option>
                                <option>Siam SCI Co.,Ltd.</option>
                                <option>Siam Steel Internaltion PLC.</option>
                                <option>Siamdent Co.,Ltd </option>
                                <option>Siamwork Technology Co.,Ltd.</option>
                                <option>Siemens Healthcare</option>
                                <option>Smart Technology and Products Co.,Ltd.</option>
                                <option>SMD rise Public Co., Ltd.</option>
                                <option>SMIT Medical Limited</option>
                                <option>Smith+Nephew Co.,Ltd.</option>
                                <option>Sodexo Thailand</option>
                                <option>Solta Medical (Thailand) Co., Ltd.</option>
                                <option>Solventum (Thailand) Ltd.</option>
                                <option>Spacemed </option>
                                <option>Spacemed Co.,Ltd.</option>
                                <option>Spiro Med Co.,Ltd.</option>
                                <option>SPK Plenties Star Co., Ltd.</option>
                                <option>Straumann Group (Thailand) Co.,Ltd.</option>
                                <option>Supreme Products </option>
                                <option>SW Healthcare Co., Ltd.</option>
                                <option>Sysmex (Thailand) Co., Ltd.</option>
                                <option>Tawan Mcweis Co.,Ltd.</option>
                                <option>Tech Ace Co.,Ltd.</option>
                                <option>Technology Promotion Association (Thailand-Japan)</option>
                                <option>Teo Hong Silom Co.,Ltd.</option>
                                <option>TEQ Co.,Ltd.</option>
                                <option>Terumo (Thailand) Co., Ltd.</option>
                                <option>Thai GL Co.,Ltd</option>
                                <option>Thai IP Co., Ltd.</option>
                                <option>Thai Otsuka Pharmaceutical Co., Ltd.</option>
                                <option>Thai Ur Kang Interntional Co.,Ltd.</option>
                                <option>Thanes Science Co.,Ltd.</option>
                                <option>The Winner Associate Co.,Ltd.</option>
                                <option>TMS Solution (Thailand) Co., Ltd.</option>
                                <option>TNS Meditronics Co., Ltd.</option>
                                <option>Topcon Instruments (Thailand) Co.,Ltd.</option>
                                <option>Transmedic (Thailand) Co.,Ltd.</option>
                                <option>Treat Med Co.,Ltd.</option>
                                <option>UB (THAILAND) CO., LTD.</option>
                                <option>UDom Medical Equiment</option>
                                <option>Ufam clinique Co.,Ltd.</option>
                                <option>Unitech Healthcare Co.,Ltd.</option>
                                <option>United BMEC (Thai) Co.,Ltd.</option>
                                <option>V R P Dent Co.,Ltd.</option>
                                <option>V.S. Engineering Co.,Ltd.</option>
                                <option>Valor Health Co.,Ltd.</option>
                                <option>Vayo Trade Center Co.,Ltd.</option>
                                <option>Vivacare Medical Ltd.</option>
                                <option>Warm Link Co., Ltd.</option>
                                <option>Watech Co.,Ltd.</option>
                                <option>Wellgate A.D.Tech Co.,Ltd.</option>
                                <option>World Medical Service &amp; Part</option>
                                <option>Xovic Co., Ltd.</option>
                                <option>Zenas Technology Company Limited.</option>
                                <option>Zepper Instruments Co.,ltd</option>
                                <option>Zest-Med Co.,Ltd.</option>
                                <option>Zimmer Biomet (Thailand) Co.,Ltd.</option>
                                <option>Z-medic Co., Ltd.</option>
                                <option>Zuelling pharma Co.,Ltd.</option>
                            </datalist>
                        </div>
                    
                        <div class="col-md-6 mt-3">
                            <label for="contact-person">
                                <i class="fas fa-address-card"></i>
                                บุคคลที่ติดต่อ
                                <span class="text-danger">*</span>
                            </label>
                            <input type="text" name="contact-person" id="contact-person" class="form-control"
                                placeholder="ชื่อผู้ติดต่อของบริษัทรับซ่อม" required>
                        </div>
                         <div class="col-md-6 mt-3">
                            <label for="contact-phone">
                                <i class="fas fa-phone"></i>
                                เบอร์โทรศัพท์
                                <span class="text-danger">*</span>
                            </label>
                            <input type="tel" name="contact-phone" id="contact-phone" class="form-control"
                                placeholder="หมายเลขโทรศัพท์" pattern="[0-9\-\s\+\(\)]+" required>
                        </div>
                        <div class="col-12 mt-3">
                            <label for="vendor-address">
                                <i class="fas fa-map-marker-alt"></i>
                                ที่อยู่บริษัท
                                <span class="text-danger">*</span>
                            </label>
                            <textarea name="vendor-address" id="vendor-address" class="form-control" rows="3"
                                placeholder="ที่อยู่ของบริษัทรับซ่อม" required></textarea>
                        </div>
                       
                            <div class="col-md-6 mt-3">
                            <label for="sender-name">
                                <i class="fas fa-user-pen"></i>
                                ผู้บันทึกข้อมูล / Recorder
                                <span class="text-danger">*</span>
                            </label>
                            <input list="recorderList" name="sender-name" id="sender-name" class="form-control"
                                placeholder="เลือกหรือกรอกชื่อผู้บันทึก" required>
                            <datalist id="recorderList">
                                <option value="" selected disabled>เลือกชื่อ</option>
                                <option value="CHAIWAT SALAIWONG">CHAIWAT SALAIWONG</option>
                                <option value="PASSAWAN TOANUN">PASSAWAN TOANUN</option>
                                <option value="PANALEE UEASUNTHONNOP">PANALEE UEASUNTHONNOP</option>
                                <option value="SERMKEAT HADJANG">SERMKEAT HADJANG</option>
                                <option value="CHANCHAI SAE-LEE">CHANCHAI SAE-LEE</option>
                                <option value="SARAN THAMMATHORN">SARAN THAMMATHORN</option>
                                <option value="PUKARIN TONGKLIANG">PUKARIN TONGKLIANG</option>
                                <option value="ANUPHAB CHANTO">ANUPHAB CHANTO</option>
                                <option value="NARUECHA CHAIYAPHAN">NARUECHA CHAIYAPHAN</option>
                                <option value="ITTIPAT IEMDEE">ITTIPAT IEMDEE</option>
                                <option value="SASIMAPORN KHANTHAHOME">SASIMAPORN KHANTHAHOME</option>
                                <option value="DARANPHOP YIMYAM">DARANPHOP YIMYAM</option>
                                <option value="CHATVIPA KAEWPRESERT">CHATVIPA KAEWPRESERT</option>
                                <option value="RAPIPHAN KHAMSUWAN">RAPIPHAN KHAMSUWAN</option>
                                <option value="SOM KONKAEW">SOM KONKAEW</option>
                                <option value="PATCHARAPORN JORNSAMER">PATCHARAPORN JORNSAMER</option>
                                <option value="RATCHATA PIRIYAKITTSAKUL">RATCHATA PIRIYAKITTSAKUL</option>
                                <option value="ILADA BUAPRALAT">ILADA BUAPRALAT</option>
                                <option value="JIRASSAYA CHUENYOO">JIRASSAYA CHUENYOO</option>
                                <option value="CHALERMPORN SABUA">CHALERMPORN SABUA</option>
                            </datalist>
                        </div>
                        <div class="col-12 mt-3">
                            <label for="remarks">
                                <i class="fas fa-comment-dots"></i>
                                หมายเหตุ / Remarks
                            </label>
                            <textarea name="remarks" id="remarks" class="form-control" rows="3"
                                placeholder="หมายเหตุเพิ่มเติม (ถ้ามี)"></textarea>
                        </div>
                        <div class="col-12 mt-3">
                            <div class="alert alert-info d-flex align-items-start gap-2 mb-0" style="border-left: 4px solid var(--primary-color);">
                                <i class="fas fa-info-circle mt-1" style="color: var(--primary-color);"></i>
                                <div>
                                    <strong>คำแนะนำ:</strong> กรอกข้อมูลบริษัทที่จะรับซ่อมให้ครบถ้วน พร้อมข้อมูลติดต่อ จากนั้นคลิก "เพิ่มรายการ" เพื่อเพิ่มรายละเอียดเครื่องมือที่ต้องการส่งซ่อม (สูงสุด 7 รายการ)
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section>
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center justify-content-between mt-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-toolbox" style="color: var(--primary-color); font-size: 24px;"></i>
                                <h4 class="fw-bold ms-2 mb-0">รายการเครื่องมือส่งซ่อม</h4>
                            </div>
                            <span class="badge bg-primary" id="equipment-count">0 รายการ</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 mt-3" id="empty-state" style="display: none;">
                            <div class="text-center py-5">
                                <i class="fas fa-inbox" style="font-size: 64px; color: var(--text-light); opacity: 0.3;"></i>
                                <p class="text-muted mt-3">ยังไม่มีรายการเครื่องมือ<br>คลิกปุ่ม "เพิ่มรายการ" เพื่อเริ่มต้น</p>
                            </div>
                        </div>
                        <div class="col-12 table-responsive mt-3" id="table-container">
                            <table id="table-equipment" class="table table-sm table-striped table-bordered table-hover">
                                <thead class="table-primary">
                                    <tr>
                                        <th style="width: 50px;">#</th>
                                        <th>ชื่อเครื่องมือ</th>
                                        <th style="width: 120px;">รหัส ME</th>
                                        <th style="width: 120px;">S/N</th>
                                        <th style="width: 200px;">สาเหตุการส่งซ่อม</th>
                                        <th style="width: 80px;">จำนวน</th>
                                        <th style="width: 80px;">ลบ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-md-4">
                            <button class="btn w-100 btn-dark mt-3" id="add-more-btn" type="button">
                                <i class="fas fa-plus-circle"></i> เพิ่มรายการเครื่องมือ
                            </button>
                        </div>
                    </div>

                </section>
                
                <!-- Signature Section -->
                <section>
                    <div class="row justify-content-start">
                        <div class="col-12 d-flex align-items-center mt-3">
                            <i class="fas fa-signature" style="color: var(--primary-color); font-size: 24px;"></i>
                            <h4 class="fw-bold ms-2 mb-0">ลายเซ็นยืนยัน</h4>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <div class="signature-box-wrapper">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-hand-holding-medical"></i>
                                    ผู้ส่งเครื่อง / Sender
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="signature-display-box" id="sender-signature-display" onclick="openSignatureModal('sender')">
                                    <div class="signature-placeholder">
                                        <i class="fas fa-pen-nib"></i>
                                        <span>คลิกเพื่อเซ็นชื่อ</span>
                                    </div>
                                    <canvas id="sender-signature-preview" style="display: none;"></canvas>
                                </div>
                                <div class="signature-info mt-2 d-flex justify-content-between align-items-center">
                                    <small class="text-muted">กดที่กรอบเพื่อเซ็นชื่อยืนยันการส่งเครื่องมือ</small>
                                    <button type="button" class="btn btn-sm btn-outline-danger d-none" id="clear-sender-signature" onclick="clearSignature('sender')">
                                        <i class="fas fa-trash-alt"></i> ลบ
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="signature-box-wrapper">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-clipboard-check"></i>
                                    ผู้รับเครื่อง / Receiver
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="signature-display-box" id="receiver-signature-display" onclick="openSignatureModal('receiver')">
                                    <div class="signature-placeholder">
                                        <i class="fas fa-pen-nib"></i>
                                        <span>คลิกเพื่อเซ็นชื่อ</span>
                                    </div>
                                    <canvas id="receiver-signature-preview" style="display: none;"></canvas>
                                </div>
                                <div class="signature-info mt-2 d-flex justify-content-between align-items-center">
                                    <small class="text-muted">กดที่กรอบเพื่อเซ็นชื่อยืนยันการรับเครื่องมือ</small>
                                    <button type="button" class="btn btn-sm btn-outline-danger d-none" id="clear-receiver-signature" onclick="clearSignature('receiver')">
                                        <i class="fas fa-trash-alt"></i> ลบ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <div class="row justify-content-center">
                    <div class="col-md-4 mt-3 text-center">
                        <button type="submit" class="btn btn-warning shadow d-none" id="submit-btn">
                            <i class="fas fa-file-pdf"></i>
                            สร้างเอกสารส่งซ่อม
                        </button>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-4 mt-3 mb-4 text-center">
                        <a id="a-download" target="_blank" style="display: none;" class="fw-bold">
                            <i class="fas fa-download"></i>
                            ดาวน์โหลด
                        </a>
                    </div>
                </div>
            </form>
            <div class="container-fluid">
                <iframe id="pdf" style="width: 100%; height: calc(100vw *(1.4142)); display: none;"></iframe>
            </div>
        </div>

    </main>

    <!-- Signature Modal -->
    <div class="modal fade signature-modal" id="signatureModal" tabindex="-1" aria-labelledby="signatureModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title signature-title" id="signatureModalLabel">
                        <i class="fas fa-signature"></i>
                        <span id="signature-modal-title">ลายเซ็นยืนยัน</span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Signature Instructions -->
                    <div class="signature-instruction">
                        <i class="fas fa-info-circle"></i>
                        <strong>คำแนะนำ:</strong> กรุณาเซ็นชื่อในกรอบด้านล่าง ใช้เมาส์หรือสัมผัสหน้าจอเพื่อวาดลายเซ็น
                    </div>
                    
                    <!-- Canvas Container -->
                    <div class="signature-canvas-container">
                        <canvas id="signatureCanvas" class="signature-canvas"></canvas>
                    </div>
                    
                    <!-- Signature Controls -->
                    <div class="signature-controls">
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-outline-secondary" id="clearSignature">
                                <i class="fas fa-eraser"></i>
                                ลบลายเซ็น
                            </button>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="fas fa-times"></i>
                                ยกเลิก
                            </button>
                            <button type="button" class="btn btn-primary" id="saveSignature">
                                <i class="fas fa-save"></i>
                                บันทึกลายเซ็น
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-1" id="offcanvasForm"
        aria-labelledby="offcanvasFormLabel">
        <div class="offcanvas-header text-bg-primary">
            <h5 class="offcanvas-title" id="offcanvasFormLabel">
                <i class="fas fa-toolbox me-2"></i>
                เพิ่มเครื่องมือส่งซ่อม
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
        </div>
        <div class="offcanvas-body bg-body-tertiary">
            <div class="alert alert-warning d-flex align-items-start gap-2 mb-3">
                <i class="fas fa-exclamation-triangle mt-1"></i>
                <small>กรอกข้อมูลให้ครบถ้วน สามารถเพิ่มได้สูงสุด 7 รายการ</small>
            </div>
            <div class="row gap-2">
                <div class="col-12">
                    <label for="e_name">
                        <i class="fas fa-stethoscope"></i>
                        ชื่อเครื่องมือ
                        <span class="text-danger">*</span>
                    </label>
                    <textarea type="text" id="e_name" class="form-control" rows="3" required
                        placeholder="ระบุชื่อเครื่องมือทางการแพทย์"></textarea>
                </div>
                <!-- code -->
                <div class="col-12">
                    <label for="e_code">
                        <i class="fas fa-barcode"></i>
                        รหัส
                    </label>
                    <input type="text" id="e_code" class="form-control" placeholder="PYT3_XXXXX">
                </div>
                <!-- sn -->
                <div class="col-12">
                    <label for="e_sn">
                        <i class="fas fa-hashtag"></i>
                        Serial Number (S/N)
                    </label>
                    <input type="text" id="e_sn" class="form-control" placeholder="S/N ของเครื่องมือ">
                </div>
                <!-- cause of failure -->
                <div class="col-12">
                    <label for="e_cause">
                        <i class="fas fa-wrench"></i>
                        สาเหตุการส่งซ่อม
                        <span class="text-danger">*</span>
                    </label>
                    <textarea type="text" id="e_cause" class="form-control" rows="3" required
                        placeholder="อธิบายอาการเสีย หรือสาเหตุที่ต้องส่งซ่อม"></textarea>
                </div>
                <!-- จำนวน -->
                <div class="col-12">
                    <label for="e_qty">
                        <i class="fas fa-boxes"></i>
                        จำนวน
                        <span class="text-danger">*</span>
                    </label>
                    <input type="number" id="e_qty" class="form-control" inputmode="numeric" value="1" min="1" max="100" required>
                </div>
                <!-- add -->
                <div class="col-12">
                    <button class="btn btn-dark w-100 mt-3" id="save-equipment-btn" type="button">
                        <i class="fas fa-check-circle"></i> บันทึกรายการ
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Google Apps Script URL for saving data to Google Sheets
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec'
        
        var form_pdf_bytes, font_bytes
        var pdfDoc
        var PDFDocument = PDFLib.PDFDocument;
        var StandardFonts = PDFLib.StandardFonts;
        var pdfFiles = []
        var equipments = []
        var time_in = 817
        $('#offcanvasForm').on('hidden.bs.offcanvas', function () {
            $('#e_name, #e_code, #e_sn, #e_cause, #e_qty').val('')
        }).on('shown.bs.offcanvas', function () {

            if (equipments.length >= 7) {
                return Swal.fire({
                    icon: 'error',
                    title: 'สามารถเพิ่มได้สูงสุด 7 รายการ',
                    text: 'เครื่องมือเกินจำนวนที่สามารถเพิ่มได้',
                    confirmButtonText: 'ตกลง'
                }), then(() => {
                    $('#offcanvasForm').offcanvas('hide')
                })
            }
            $('#e_name').focus()

        })
        // Signature functionality
        let signaturePad;
        let currentSignatureType = '';
        let signatures = {
            sender: null,
            receiver: null
        };

        // Resize canvas to fit container
        function resizeCanvas() {
            const canvas = document.getElementById('signatureCanvas');
            const container = document.querySelector('.signature-canvas-container');
            
            if (canvas && container) {
                const containerRect = container.getBoundingClientRect();
                const maxWidth = Math.min(650, containerRect.width - 40); // 40px for padding
                const maxHeight = 300;
                
                // Set canvas size
                canvas.width = maxWidth;
                canvas.height = maxHeight;
                
                // Update CSS for proper display
                canvas.style.width = maxWidth + 'px';
                canvas.style.height = maxHeight + 'px';
                
                // Reinitialize signature pad if it exists
                if (signaturePad) {
                    signaturePad.clear();
                }
            }
        }

        // Initialize signature pad
        function initializeSignaturePad() {
            const canvas = document.getElementById('signatureCanvas');
            
            // Set canvas size to fit the container
            resizeCanvas();
            
            signaturePad = new SignaturePad(canvas, {
                backgroundColor: 'rgba(255,255,255,1)',
                penColor: '#1212ff', // Bright blue pen color
                minWidth: 1,
                maxWidth: 3,
                throttle: 16
            });

            // Clear signature button
            document.getElementById('clearSignature').addEventListener('click', function() {
                signaturePad.clear();
            });

            // Save signature button
            document.getElementById('saveSignature').addEventListener('click', function() {
                if (signaturePad.isEmpty()) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'ไม่พบลายเซ็น',
                        text: 'กรุณาเซ็นชื่อก่อนบันทึก',
                        confirmButtonColor: '#6a1b9a'
                    });
                    return;
                }

                // Save signature as coordinate data (minimal storage)
                const coordinateData = {
                    points: signaturePad.toData(),
                    width: document.getElementById('signatureCanvas').offsetWidth,
                    height: document.getElementById('signatureCanvas').offsetHeight,
                    penColor: '#1212ff'
                };
                const signatureData = signaturePad.toDataURL();
                signatures[currentSignatureType] = {
                    coordinates: JSON.stringify(coordinateData),
                    dataURL: signatureData
                };

                // Update preview
                updateSignaturePreview(currentSignatureType, signatureData);

                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('signatureModal'));
                modal.hide();

                Swal.fire({
                    icon: 'success',
                    title: 'บันทึกสำเร็จ',
                    text: 'ลายเซ็นถูกบันทึกเรียบร้อยแล้ว',
                    timer: 1500,
                    showConfirmButton: false
                });
            });
        }

        // Open signature modal
        function openSignatureModal(type) {
            currentSignatureType = type;
            
            // Update modal title
            const titles = {
                sender: 'ลายเซ็นผู้ส่งเครื่อง',
                receiver: 'ลายเซ็นผู้รับเครื่อง'
            };
            document.getElementById('signature-modal-title').textContent = titles[type];
            
            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('signatureModal'));
            modal.show();
            
            // Initialize signature pad when modal is shown
            setTimeout(() => {
                // Always resize canvas when modal opens
                resizeCanvas();
                
                if (!signaturePad) {
                    initializeSignaturePad();
                } else {
                    signaturePad.clear();
                    // Load existing signature if available
                    if (signatures[type]) {
                        if (signatures[type].coordinates) {
                            // Load from coordinate data
                            const coordData = JSON.parse(signatures[type].coordinates);
                            signaturePad.fromData(coordData.points);
                        } else {
                            // Fallback to dataURL for backward compatibility
                            const signatureData = signatures[type].dataURL || signatures[type];
                            signaturePad.fromDataURL(signatureData);
                        }
                    }
                }
            }, 300);
        }

        // Update signature preview
        function updateSignaturePreview(type, signatureData) {
            const displayBox = document.getElementById(`${type}-signature-display`);
            const placeholder = displayBox.querySelector('.signature-placeholder');
            const preview = displayBox.querySelector(`#${type}-signature-preview`);
            const clearButton = document.getElementById(`clear-${type}-signature`);
            
            if (signatureData) {
                // Hide placeholder and show signature
                placeholder.style.display = 'none';
                preview.style.display = 'block';
                displayBox.classList.add('has-signature');
                clearButton.classList.remove('d-none');
                
                // Draw signature on preview canvas
                const ctx = preview.getContext('2d');
                const img = new Image();
                img.onload = function() {
                    preview.width = displayBox.offsetWidth - 20;
                    preview.height = displayBox.offsetHeight - 20;
                    ctx.clearRect(0, 0, preview.width, preview.height);
                    ctx.drawImage(img, 0, 0, preview.width, preview.height);
                };
                // Handle both old format (string) and new format (object)
                img.src = signatureData.dataURL || signatureData;
            } else {
                // Show placeholder and hide signature
                placeholder.style.display = 'flex';
                preview.style.display = 'none';
                displayBox.classList.remove('has-signature');
                clearButton.classList.add('d-none');
            }
        }

        // Validate signatures
        function validateSignatures() {
            const errors = [];
            
            if (!signatures.sender || (!signatures.sender.coordinates && !signatures.sender.dataURL && !signatures.sender)) {
                errors.push('กรุณาเซ็นชื่อผู้ส่งเครื่อง');
            }
            
            if (!signatures.receiver || (!signatures.receiver.coordinates && !signatures.receiver.dataURL && !signatures.receiver)) {
                errors.push('กรุณาเซ็นชื่อผู้รับเครื่อง');
            }
            
            return errors;
        }

        // Clear signature
        function clearSignature(type) {
            signatures[type] = null;
            updateSignaturePreview(type, null);
        }

        // Recreate signature from coordinate data
        function recreateSignatureFromCoordinates(coordinateData) {
            const canvas = document.createElement('canvas');
            const coordData = JSON.parse(coordinateData);
            
            canvas.width = coordData.width;
            canvas.height = coordData.height;
            
            const tempPad = new SignaturePad(canvas, {
                backgroundColor: 'rgba(255,255,255,1)',
                penColor: coordData.penColor || '#1212ff'
            });
            
            tempPad.fromData(coordData.points);
            return canvas.toDataURL();
        }

        // Handle window resize for signature previews
        window.addEventListener('resize', function() {
            ['sender', 'receiver'].forEach(type => {
                if (signatures[type]) {
                    updateSignaturePreview(type, signatures[type]);
                }
            });
        });

        $(document).ready(async function () {
            form_pdf_bytes = await fetch('./outsourceForm.pdf').then(res => res.arrayBuffer())
            pdfDoc = await PDFDocument.load(form_pdf_bytes)
            font_bytes = await fetch('../teampm/THSarabun.ttf').then(res => res.arrayBuffer())
            renderTable()
            updateStats()
            
            // Restore saved values
            const savedFields = ['sender-name', 'vender-name', 'contact-person', 'vendor-address', 'contact-phone']
            savedFields.forEach(field => {
                const value = localStorage.getItem(field)
                if (value) $(`#${field}`).val(value)
            })
            
            // Auto-save on input
            savedFields.forEach(field => {
                $(`#${field}`).on('input', function () {
                    localStorage.setItem(field, $(this).val())
                })
            })
        })

        // Function to save data to Google Sheets
        async function saveData(formData) {
            try {
                const response = await $.ajax({
                    url: GOOGLE_SCRIPT_URL,
                    method: 'POST',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify(formData)
                })
           
                return response.success;
            } catch (error) {
                console.error('Error connecting to Google Sheets:', error)
                return false
            }
        }

        $('#add-more-btn').click(function () {
            $('#offcanvasForm').offcanvas('show')
        })

        $('#save-equipment-btn').click(function () {
            let e_name = $('#e_name').val().trim()
            let e_code = $('#e_code').val().trim()
            let e_sn = $('#e_sn').val().trim()
            let e_cause = $('#e_cause').val().trim()
            let e_qty = $('#e_qty').val()

            // Validation
            if (!e_name) {
                Swal.fire({
                    icon: 'warning',
                    title: 'กรุณากรอกชื่อเครื่องมือ',
                    text: 'ชื่อเครื่องมือเป็นข้อมูลที่จำเป็น',
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: '#8165b2'
                })
                $('#e_name').focus()
                return
            }

            if (!e_cause) {
                Swal.fire({
                    icon: 'warning',
                    title: 'กรุณากรอกสาเหตุการส่งซ่อม',
                    text: 'สาเหตุการส่งซ่อมเป็นข้อมูลที่จำเป็น',
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: '#8165b2'
                })
                $('#e_cause').focus()
                return
            }

            if (equipments.length >= 7) {
                Swal.fire({
                    icon: 'error',
                    title: 'เพิ่มรายการไม่ได้',
                    text: 'สามารถเพิ่มรายการได้สูงสุด 7 รายการเท่านั้น',
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: '#ef4444'
                })
                return
            }

            equipments.push({
                e_name,
                e_code,
                e_sn,
                e_cause,
                e_qty
            })
            localStorage.setItem('equipments', JSON.stringify(equipments))
            renderTable()
            updateStats()
            $('#offcanvasForm').offcanvas('hide')
            
            Swal.fire({
                icon: 'success',
                title: 'เพิ่มรายการสำเร็จ',
                text: `เพิ่ม "${e_name}" เรียบร้อยแล้ว`,
                timer: 1500,
                showConfirmButton: false
            })
        })

        function renderTable() {
            let data = localStorage.getItem('equipments')
            if (data) {
                equipments = JSON.parse(data)
            } else {
                equipments = []
            }
            
            // Toggle visibility based on equipment count
            if (equipments.length > 0) {
                $('#submit-btn').removeClass('d-none')
                $('#empty-state').hide()
                $('#table-container').show()
            } else {
                $('#submit-btn').addClass('d-none')
                $('#empty-state').show()
                $('#table-container').hide()
            }
            
            $('#table-equipment').DataTable({
                destroy: true,
                data: equipments,
                dom: '<"row"<"col-12"B>><"row"<"col-12"t>>',
                ordering: false,
                columns: [
                    {
                        data: null,
                        title: '#',
                        render: function (data, type, row, meta) {
                            return meta.row + 1
                        }
                    },
                    { data: 'e_name' },
                    { data: 'e_code' },
                    { data: 'e_sn' },
                    { data: 'e_cause' },
                    { data: 'e_qty' },
                    {
                        data: null,
                        title: '#',
                        render: function (data, type, row, meta) {
                            return `<button class="btn btn-danger btn-sm" style="font-size: .7rem" onclick="removeEquipment(${meta.row})"><i class="bi bi-trash"></i></button>`
                        }
                    }
                ],
                columnDefs: [
                    {
                        targets: '_all',
                        className: 'dt-head-center'
                    },
                    {
                        targets: [0, 5],
                        className: 'dt-body-center'
                    }
                ],
                language: {
                    search: 'ค้นหา',
                    searchPlaceholder: 'ค้นหา',
                    info: 'แสดง _START_ ถึง _END_ จาก _TOTAL_ รายการ',
                    infoEmpty: 'แสดง 0 ถึง 0 จาก 0 รายการ',
                    infoFiltered: '(กรองจาก _MAX_ รายการทั้งหมด)',
                    zeroRecords: 'ไม่พบข้อมูล',
                    emptyTable: 'ไม่มีข้อมูล',
                    paginate: {
                        first: 'หน้าแรก',
                        previous: 'ก่อนหน้า',
                        next: 'ถัดไป',
                        last: 'หน้าสุดท้าย'
                    }
                }
            })
        }

        function removeEquipment(index) {
            Swal.fire({
                title: 'ยืนยันการลบ',
                text: `ต้องการลบรายการ "${equipments[index].e_name}" หรือไม่?`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'ลบ',
                cancelButtonText: 'ยกเลิก'
            }).then((result) => {
                if (result.isConfirmed) {
                    equipments.splice(index, 1)
                    localStorage.setItem('equipments', JSON.stringify(equipments))
                    renderTable()
                    updateStats()
                    Swal.fire({
                        icon: 'success',
                        title: 'ลบรายการสำเร็จ',
                        timer: 1500,
                        showConfirmButton: false
                    })
                }
            })
        }

        function updateStats() {
            const totalItems = equipments.length
            $('#equipment-count').text(`${totalItems} รายการ`)
        }

        $('#myForm').submit(async function (e) {
            event.preventDefault()
            
            // Validate form
            let vender_name = $('#vender-name').val().trim()
            let sender_name = $('#sender-name').val().trim()
            let contact_person = $('#contact-person').val().trim()
            let vendor_address = $('#vendor-address').val().trim()
            let contact_phone = $('#contact-phone').val().trim()
            
            // Validation
            const validationChecks = [
                { field: vender_name, name: 'ชื่อบริษัทรับซ่อม', focus: '#vender-name' },
                { field: sender_name, name: 'ชื่อผู้บันทึก', focus: '#sender-name' },
                { field: contact_person, name: 'บุคคลที่ติดต่อ', focus: '#contact-person' },
                { field: vendor_address, name: 'ที่อยู่บริษัท', focus: '#vendor-address' },
                { field: contact_phone, name: 'เบอร์โทรศัพท์', focus: '#contact-phone' }
            ]
            
            for (let check of validationChecks) {
                if (!check.field) {
                    Swal.fire({
                        icon: 'warning',
                        title: `กรุณากรอก${check.name}`,
                        text: 'ข้อมูลนี้จำเป็นสำหรับการสร้างเอกสาร',
                        confirmButtonText: 'ตกลง',
                        confirmButtonColor: '#8165b2'
                    })
                    $(check.focus).focus()
                    return
                }
            }
            
            if (equipments.length === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ไม่มีรายการเครื่องมือ',
                    text: 'กรุณาเพิ่มรายการเครื่องมือที่ต้องการส่งซ่อมอย่างน้อย 1 รายการ',
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: '#8165b2'
                })
                return
            }
            
            // Validate signatures
            const signatureErrors = validateSignatures();
            if (signatureErrors.length > 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ลายเซ็นไม่ครบถ้วน',
                    html: signatureErrors.join('<br>'),
                    confirmButtonText: 'ตกลง',
                    confirmButtonColor: '#8165b2'
                })
                return
            }
            
            // Show loading
            Swal.fire({
                title: 'กำลังสร้างเอกสารและบันทึกข้อมูล...',
                text: 'กรุณารอสักครู่',
                allowOutsideClick: false,
                didOpen: () => {
                    Swal.showLoading()
                }
            })
            
            // Prepare data for Google Sheets
            const formData = {
                timestamp: new Date().toISOString(),
                date: new Date().toLocaleDateString('th-TH'),
                venderName: vender_name,
                senderName: sender_name,
                contactPerson: contact_person,
                vendorAddress: vendor_address,
                contactPhone: contact_phone,
                equipmentCount: equipments.length,
                totalQuantity: equipments.reduce((sum, item) => sum + parseInt(item.e_qty || 0), 0),
                senderSignatureCoordinates: signatures.sender?.coordinates ? JSON.parse(signatures.sender.coordinates) : null,
                receiverSignatureCoordinates: signatures.receiver?.coordinates ? JSON.parse(signatures.receiver.coordinates) : null,
                equipments: equipments.map((eq, index) => ({
                    no: index + 1,
                    name: eq.e_name,
                    code: eq.e_code,
                    sn: eq.e_sn,
                    cause: eq.e_cause,
                    quantity: eq.e_qty
                }))
            }

            console.log('Form Data to be saved:', formData);
            
            // Save to Google Sheets
            const saveSuccess = await saveData(formData)
            
            if (!saveSuccess) {
                Swal.fire({
                    icon: 'warning',
                    title: 'ไม่สามารถบันทึกข้อมูลได้',
                    text: 'ระบบจะสร้างเอกสาร PDF ต่อไป แต่ข้อมูลอาจไม่ได้บันทึกใน Google Sheets',
                    confirmButtonText: 'ดำเนินการต่อ',
                    confirmButtonColor: '#8165b2'
                })
            }
            
            if (!pdfDoc) pdfDoc = await PDFDocument.load(form_pdf_bytes)
            var form = pdfDoc.getForm()
            pdfDoc.registerFontkit(fontkit);
            const sarabun = await pdfDoc.embedFont(font_bytes, { subset: true })
            const symbol = await pdfDoc.embedFont(StandardFonts.ZapfDingbats, { subset: true })
            var signature, e_img
            // Use existing variables from validation above
            vender_name = $('#vender-name').val()
            sender_name = $('#sender-name').val()
            let [date, month, year] = new Date().toLocaleString('en-GB', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            }).split(' ')
            console.log(date, month, year);

            form.getTextField('vender_name').setText(toTitleCase(vender_name))
            form.getTextField('sender_name').setText(toTitleCase(sender_name))
            
            // Add contact information if fields exist in PDF form
            try {
                if ($('#contact-person').val()) {
                    const contactField = form.getTextField('contact_person')
                    if (contactField) contactField.setText(toTitleCase($('#contact-person').val()))
                }
            } catch (e) { console.log('Contact person field not found in PDF') }
            
            try {
                if ($('#vendor-address').val()) {
                    const addressField = form.getTextField('vendor_address')
                    if (addressField) addressField.setText($('#vendor-address').val())
                }
            } catch (e) { console.log('Vendor address field not found in PDF') }
            
            try {
                if ($('#contact-phone').val()) {
                    const phoneField = form.getTextField('contact_phone')
                    if (phoneField) phoneField.setText($('#contact-phone').val())
                }
            } catch (e) { console.log('Contact phone field not found in PDF') }
            form.getTextField('date').setText(date)
            form.getTextField('month').setText(month)
            form.getTextField('year').setText(year)
            
            // Add signatures to PDF
            if (signatures.sender) {
                try {
                    let senderSignatureData;
                    if (signatures.sender.coordinates) {
                        // Recreate from coordinate data
                        senderSignatureData = recreateSignatureFromCoordinates(signatures.sender.coordinates);
                    } else {
                        // Use existing dataURL
                        senderSignatureData = signatures.sender.dataURL || signatures.sender;
                    }
                    
                    const senderSignatureImage = await pdfDoc.embedPng(senderSignatureData)
                    const pages = pdfDoc.getPages()
                    const firstPage = pages[0]
                    const { width, height } = firstPage.getSize()
                    
                    // Add sender signature (adjust coordinates as needed)
                    firstPage.drawImage(senderSignatureImage, {
                        x: 100,
                        y: 150,
                        width: 120,
                        height: 60,
                    })
                } catch (error) {
                    console.warn('Error adding sender signature:', error)
                }
            }
            
            if (signatures.receiver) {
                try {
                    let receiverSignatureData;
                    if (signatures.receiver.coordinates) {
                        // Recreate from coordinate data
                        receiverSignatureData = recreateSignatureFromCoordinates(signatures.receiver.coordinates);
                    } else {
                        // Use existing dataURL
                        receiverSignatureData = signatures.receiver.dataURL || signatures.receiver;
                    }
                    
                    const receiverSignatureImage = await pdfDoc.embedPng(receiverSignatureData)
                    const pages = pdfDoc.getPages()
                    const firstPage = pages[0]
                    
                    // Add receiver signature (adjust coordinates as needed)
                    firstPage.drawImage(receiverSignatureImage, {
                        x: 350,
                        y: 150,
                        width: 120,
                        height: 60,
                    })
                } catch (error) {
                    console.warn('Error adding receiver signature:', error)
                }
            }
            console.log(equipments);
            equipments.forEach((e, i) => {
                form.getTextField(`num${i}`).setText(toTitleCase((i + 1).toString()))
                form.getTextField(`e_${i}`).setText(toTitleCase(e.e_name))
                form.getTextField(`q_${i}`).setText(e.e_qty)
                form.getTextField(`ME CodeRow${i}`).setText(e.e_code)
                form.getTextField(`SNRow${i}`).setText(e.e_sn)
                form.getTextField(`cause_${i}`).setText(e.e_cause)
            })
            form.updateFieldAppearances(sarabun);
            form.flatten()
            var pdfBytes = await pdfDoc.save()
            var pdfdatauri = await pdfDoc.saveAsBase64({ dataUri: true })
            Swal.fire({
                icon: 'success',
                title: 'สร้างเอกสารสำเร็จ!',
                html: `
                    <p>สร้างเอกสารส่งซ่อมเรียบร้อยแล้ว</p>
                    <div class="mt-3">
                        <strong>บริษัท:</strong> ${vender_name}<br>
                        <strong>ผู้ติดต่อ:</strong> ${$('#contact-person').val()}<br>
                        <strong>รายการ:</strong> ${equipments.length} รายการ<br>
                        <strong>จำนวนรวม:</strong> ${equipments.reduce((sum, item) => sum + parseInt(item.e_qty || 0), 0)} ชิ้น<br>
                        <strong>สถานะบันทึก:</strong> ${saveSuccess ? '<span style="color: green;">✓ บันทึกใน Google Sheets แล้ว</span>' : '<span style="color: orange;">⚠ ไม่สามารถบันทึกใน Google Sheets</span>'}
                    </div>
                `,
                confirmButtonText: 'ดูเอกสาร',
                confirmButtonColor: '#8165b2',
                timer: 4000
            }).then(async () => {
                // Clear form data after successful submission
                const fieldsToRemove = ['equipments', 'vender-name', 'sender-name', 'contact-person', 'vendor-address', 'contact-phone']
                fieldsToRemove.forEach(field => localStorage.removeItem(field))
                var iframe = document.getElementById('pdf')
                // open pdf in new small window
                var blob = new Blob([pdfBytes], { type: 'application/pdf' })
                var url = URL.createObjectURL(blob)
                if (window.innerWidth < 768) {
                    window.open(url + '#toolbar=1', '_blank')
                    return
                }
                iframe.src = url + '#toolbar=1&zoom=75'
                // disable download

                let name = 'TIMESHEET ' + new Date().getTime() + '.pdf'
                $(iframe).show(200)
                $(iframe).attr('download', name)
                $(iframe).attr('title', name)
                $('#print-btn').parent().removeClass('d-none')
                $('#print-btn').click(function () {
                    iframe.contentWindow.print()
                })


                // scroll to pdf
                $('html, body').animate({
                    scrollTop: $(iframe).offset().top
                }, 500);
                pdfDoc = await PDFDocument.load(form_pdf_bytes)

            })

        })

        // Handle window resize for responsive canvas
        $(window).resize(function() {
            if (signaturePad) {
                resizeCanvas();
            }
        });

        function toTitleCase(str) {
            return str.replace(
                /\w\S*/g,
                function (txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                }
            );
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/locale/th.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/l10n/th.js"></script>
    <script src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@5.0.10/dist/signature_pad.umd.min.js"></script>
    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
    <script>
        // VConsole will be exported to `window.VConsole` by default.
        var vConsole = new window.VConsole();
    </script>
</body>

</html>