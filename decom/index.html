<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/pdf-lib@1.4.0/dist/pdf-lib.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100%;
            height: 100%;
            /* background-color: #D3D3D3; */
        }

        #sticker {
            width: 100%;
            height: 100%;
        }
    </style>
    <title>Decommission Form</title>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 text-center px-5 mt-3">
                <img src="https://img.in.th/images/92cc41f62e7a8b08398ed7cddcc22725.jpg" alt="banner" class="img-fluid">
            </div>
        </div>

        <form id="myForm" class="mt-3 mb-5">
            <div class="row justify-content-center">
                <div class="col text-center">
                    <h4>Decommissioning Determination Form</h4>
                    <h4>‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h4>
                </div>
            </div>
            <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow border border-primary">
                <div class="row justify-content-start">
                    <div class="col-md-4 mt-3">
                        <label for="e_name">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</label>
                        <input type="text" name="e_name" id="e_name" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="dept">‡πÅ‡∏ú‡∏ô‡∏Å</label>
                        <select name="dept" id="dept" class="form-select">
                            <option value="" disabled selected>Select value</option>
                            <option>ANESTHESIA (‡∏ß‡∏¥‡∏™‡∏±‡∏ç‡∏ç‡∏µ)</option>
                            <option>ART-LAB (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏ö‡∏∏‡∏ï‡∏£‡∏¢‡∏≤‡∏Å)</option>
                            <option>BME-PYT3</option>
                            <option>CATH-LAB</option>
                            <option>CHECK-UP (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û)</option>
                            <option>CORPORATE CUSTOMER SERVICE</option>
                            <option>CSSD (‡∏à‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏≤‡∏á)</option>
                            <option>DENTAL (‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°)</option>
                            <option>DIABETIC&amp;METABOLIC(‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô)</option>
                            <option>EENT( ‡∏´‡∏π‡∏ï‡∏≤‡∏Ñ‡∏≠‡∏à‡∏°‡∏π‡∏Å)</option>
                            <option>EMERGENCY( ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)</option>
                            <option>GASTROINTESTINAL LABORATORY(GI)</option>
                            <option>HEMODIALYSIS (‡πÑ‡∏ï‡πÄ‡∏ó‡∏µ‡∏¢‡∏°)</option>
                            <option>HOPD CENTER (‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á)</option>
                            <option>INFECTION CONTROL ( IC)</option>
                            <option>INTENSIVE CARE UNIT(‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏ô‡∏±‡∏Å)</option>
                            <option>LABOR ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏•‡∏≠‡∏î)</option>
                            <option>LABORATORY</option>
                            <option>MAID</option>
                            <option>MARKETING</option>
                            <option>NURSERY(‡πÄ‡∏î‡πá‡∏Å‡∏≠‡πà‡∏≠‡∏ô)</option>
                            <option>NURSING DEPARTMENT</option>
                            <option>OBSERVE(‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£)</option>
                            <option>OPD CARDIO(‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏´‡∏±‡∏ß‡πÉ‡∏à)</option>
                            <option>OPD COUNTER NURSE (CN ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á)</option>
                            <option>OPD HEAD NECK BREAST(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°)</option>
                            <option>OPD MEDICINE(‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏£‡∏£‡∏°)</option>
                            <option>OPD NEURO (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏°‡∏≠‡∏á)</option>
                            <option>OPD OB/GYN(‡∏®‡∏∏‡∏ô‡∏¢‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏´‡∏ç‡∏¥‡∏á)</option>
                            <option>OPD PEDIATRIC( ‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡πá‡∏Å)</option>
                            <option>OPD SURGERY(‡∏®‡∏±‡∏•‡∏¢‡∏Å‡∏£‡∏£‡∏°)</option>
                            <option>OPD UROLOGY (‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞)</option>
                            <option>OPERATING ROOM(‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î)</option>
                            <option>PHARMARCY(‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏° ‡∏´‡πâ‡∏≠‡∏á‡∏¢‡∏≤)</option>
                            <option>PHYATHAI BEAUTY CENTER (PBC ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°)</option>
                            <option>PHYSICAL THERAPY( ‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û)</option>
                            <option>PICU</option>
                            <option>PWA LIFE CENTER</option>
                            <option>PWA ‡∏ä‡∏∞‡∏•‡∏≠‡∏ß‡∏±‡∏¢</option>
                            <option>WARD 10</option>
                            <option>WARD 11</option>
                            <option>WARD 12</option>
                            <option>WARD 14</option>
                            <option>WARD 15</option>
                            <option>WARD 17</option>
                            <option>WARD 7</option>
                            <option>WARD 8</option>
                            <option>WARD 9</option>
                            <option>X-RAY</option>
                            <option>‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á</option>
                            <option>‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô 19</option>
                        </select>
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_manufacturer">‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï</label>
                        <input type="text" name="e_manufacturer" id="e_manufacturer" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</label>
                        <input type="text" name="e_date" id="e_date" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_hospital_code">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</label>
                        <input type="text" name="e_hospital_code" id="e_hospital_code" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_brand/model">‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡∏£‡∏∏‡πà‡∏ô</label>
                        <input type="text" name="e_brand/model" id="e_brand/model" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_sn">‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (SN)</label>
                        <input type="text" name="e_sn" id="e_sn" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_me_code">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (ME Code)</label>
                        <input type="text" name="e_me_code" id="e_me_code" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_brand/distributor">‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢</label>
                        <input type="text" name="e_brand/distributor" id="e_brand/distributor" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠</label>
                        <input type="text" name="e_price" id="e_price" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_depreciation">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                        <input type="text" name="e_depreciation" id="e_depreciation" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_decom_location">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
                        <input type="text" name="e_decom_location" id="e_decom_location" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_decom_by">‡∏ú‡∏π‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</label>
                        <input type="text" name="e_decom_by" id="e_decom_by" class="form-control">
                    </div>
                    <div class="col-md-4 mt-3">
                        <label for="e_sticker">‡∏£‡∏π‡∏õ Code Sticker ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</label>
                        <input type="file" accept="image/*" name="e_sticker" id="e_sticker" class="form-control">
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-4 mt-3" style="display: none;">
                        <img alt="sticker" id="sticker" class="img-fluid">
                    </div>
                </div>
            </section>
            <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow border border-info">
                <div class="row justify-content-start">
                    <div class="col text-start ms-1">
                        <p>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå</p>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="repair_cost_exceed_65" name="repair_cost_exceed_65">
                            <label class="form-check-label" for="repair_cost_exceed_65">
                                1. ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏™‡∏∞‡∏™‡∏°‡∏£‡∏ß‡∏°‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 65% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ (The estimated cumulative repair cost exceed 65% of acquisition Cost)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="deprecate_value_exceed_65" name="deprecate_value_exceed_65">
                            <label class="form-check-label" for="deprecate_value_exceed_65">
                                2. ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 65% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ (Current deprecated value exceed 65% of acquisition cost)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="any_uncorrecttable_hazard" name="any_uncorrecttable_hazard">
                            <label class="form-check-label" for="any_uncorrecttable_hazard">
                                3. ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å Status Decom (Any uncorrectable hazard
                                warning preclude equipment use / Disable operations caused by Status Decom)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="lack_of_repair_part" name="lack_of_repair_part">
                            <label class="form-check-label" for="lack_of_repair_part">
                                4. ‡∏Ç‡∏≤‡∏î‡πÅ‡∏Ñ‡∏•‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÑ‡∏î‡πâ (The lack of repair parts render
                                equipment irreparable)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="calibration_inacculate" name="calibration_inacculate">
                            <label class="form-check-label" for="calibration_inacculate">
                                5. ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏î‡πâ (Calibration measurement range inacceurate and cannot adjusted)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="expected_life" name="expected_life">
                            <label class="form-check-label" for="expected_life">
                                6. ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ECRI ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏∏‡∏ô Expected Life Healthcare Device (SD-BME-BMC-00-
                                MN-001)/ ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ç‡∏≠‡∏á‡∏≠‡∏∞‡πÉ‡∏´‡∏•‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏≠‡∏á‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ú‡∏π‡πâ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î (Expccted Life Healthcare
                                Device ECRI /Age of spare parts and discontinuation of parts as specified by the representative company)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="high_priority_replcaement" name="high_priority_replcaement">
                            <label class="form-check-label" for="high_priority_replcaement">
                                7. ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏Ç‡πå ‡∏°‡∏µ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏π‡∏á (Summary of the evaluation of the medical
                                device condition High Priority Replacement)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="outdated_technology" name="outdated_technology">
                            <label class="form-check-label" for="outdated_technology">
                                8. ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡∏•‡πâ‡∏≤‡∏™‡∏°‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ ( Outdated technology assessment )
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="required_termination_of_use" name="required_termination_of_use">
                            <label class="form-check-label" for="required_termination_of_use">
                                9. ‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (Regulations require the termination of use.)
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="‚úì" id="information_deleted" name="information_deleted">
                            <label class="form-check-label" for="information_deleted">
                                10. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
                            </label>
                        </div>
                    </div>
                    <div class="col-12 text-start ms-1 mt-2">
                        <label for="e_sticker"> 11. ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                        <input name="other" id="other" name="other" class="form-control">
                    </div>
                </div>
            </section>
            <section class="m-2 mt-4 rounded-2 bg-light p-4 shadow border border-success">
                <div class="row justify-content-center align-items-start">
                    <div class="col-md-4 mt-3 text-center">
                        <label for="1-file-nsmart">‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ö‡∏á‡∏≤‡∏ô NSmart</label>
                        <input type="file" name="1-file-nsmart" accept="application/pdf" id="1-file-nsmart" class="form-control file">
                        <iframe class="mt-2" frameborder="0" notoolbar=1 style="display: none; width: 100%; height: calc(100vw *(1.4142/3.45));"></iframe>
                    </div>
                    <div class="col-md-4 mt-3 text-center">
                        <label for="2-file-img">‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                        <input type="file" name="2-file-img" id="2-file-img" accept="application/pdf" class="form-control file">
                        <iframe class="mt-2" frameborder="0" notoolbar=1 style="display: none; width: 100%; height: calc(100vw *(1.4142/3.45));"></iframe>
                    </div>
                    <div class="col-md-4 mt-3 text-center">
                        <label for="3-file-other">‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
                        <input type="file" name="3-file-other" id="3-file-other" accept="application/pdf" class="form-control file">
                        <iframe class="mt-2" frameborder="0" notoolbar=1 style="display: none; width: 100%; height: calc(100vw *(1.4142/3.45));"></iframe>
                    </div>
                </div>
            </section>
            <div class="row justify-content-center">
                <div class="col-md-4 mt-3 text-center">
                    <button type="submit" class="btn btn-primary" style="min-width: 200px;">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå</button>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-4 mt-3 mb-4 text-center">
                    <a id="a-download" target="_blank" style="display: none;" class="fw-bold">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</a>
                </div>
            </div>
        </form>
        <iframe id="pdf" style="width: 100%; height: calc(100vw *(1.4142)); display: none;"></iframe>
    </div>
    <footer>
        <div class="row justify-content-center">
            <div class="col text-center">
                <img src="https://img.in.th/images/e4d09ac180fac9fc6bb998593ef6bc30.jpg" alt="footer" class="img-fluid" style="max-width:150px">
            </div>
        </div>
    </footer>
    <script>
        $(document).ready(function () {
            $('#dept option').not(':disabled').each(function () {
                $(this).val($(this).text());
            });
        })
    </script>
    <script>
        var pdfDoc
        var PDFDocument = PDFLib.PDFDocument;
        $('#myForm').submit(async function () {
            pdfDoc = await PDFDocument.create();
            event.preventDefault()
            let formData = $(this).serializeArray()
            let obj = {}
            formData.forEach(function (e) {
                if (e.value == '') e.value = '-'
                obj[e.name] = e.value
            })
            $('input[type=checkbox]').each(function () {
                if ($(this).is(':checked')) {
                    obj[$(this).attr('name')] = '‚úì'
                } else {
                    obj[$(this).attr('name')] = ''
                }
            })
            if (sticker.data) obj.e_sticker = JSON.stringify(sticker)
            obj['e_me_code'] = obj['e_me_code'].toUpperCase().indexOf('PYT') > -1 ? obj['e_me_code'].toUpperCase() : ('PYT3_' + ('00000' + obj['e_me_code']).slice(-5))
            obj['e_decom_by'] = obj['e_decom_by'].toUpperCase()
            obj['e_name'] = toTitleCase(obj['e_name'])
            Swal.fire({
                icon: 'info',
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå...',
                allowOutsideClick: false,
            })
            Swal.showLoading(Swal.getConfirmButton())
            Object.keys(pdfFiles).forEach(async key => {
                let pdf = await PDFDocument.load(pdfFiles[key])
                let pages = pdf.getPages().length
                for (var i = 0; i < pages; i++) {
                    let [page] = await pdfDoc.copyPages(pdf, [i])
                    pdfDoc.insertPage(0, page)
                }
            })
            let scripturl = 'https://script.google.com/macros/s/AKfycbwdHWd3KFg6GMJsNKmVp69oyRAhpzWRjiWxUYFU8QBXoLHkNYM07qUEbR0s5roYpAnHag/exec?opt=save'
            $.ajax({
                url: scripturl,
                type: 'POST',
                data: obj,
                success: function (data) {
                    copyPages(data[0], data[1], data[2])
                }
            })
        })
        var sticker = {}
        $('#e_sticker').change(function () {
            sticker = {}
            var file = this.files[0]
            var reader = new FileReader()
            reader.onload = function (e) {
                sticker.data = e.target.result
                sticker.name = file.name
                $('.img-fluid').attr('src', e.target.result)
                $('.img-fluid').closest('.col-md-4').show()
            }
            reader.readAsDataURL(file)
        })
        function toTitleCase(str) {
            return str.replace(
                /\w\S*/g,
                function (txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                }
            );
        }
    </script>
    <script>
        async function copyPages(url, res, name) {
            var binary_string = window.atob(res);
            var len = binary_string.length;
            var bytes = new Uint8Array(len);
            for (var i = 0; i < len; i++) {
                bytes[i] = binary_string.charCodeAt(i);
            }
            const firstPDFBytes = bytes.buffer
            const firstPDFDoc = await PDFDocument.load(firstPDFBytes)
            const [firstPDFPage] = await pdfDoc.copyPages(firstPDFDoc, [0])
            pdfDoc.insertPage(0, firstPDFPage)
            const pdfBytes = await pdfDoc.save()
            const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
            Swal.fire({
                icon: 'success',
                title: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',
                timer: 2000,
                showConfirmButton: false,
            })
            $('#a-download').attr('href', pdfDataUri)
            $('#a-download').attr('download', name).show()
            var iframe = document.getElementById('pdf')
            iframe.src = pdfDataUri
            $(iframe).slideDown(100)
        }
        let pdfFiles = []
        $('.file').change(function () {
            let files = this.files
            for (var i = 0; i < files.length; i++) {
                let obj = this
                let id = $(this).attr('id')
                let file = files[i]
                let reader = new FileReader();
                let reader2 = new FileReader();
                reader.onloadend = function (e) {
                    pdfFiles[id] = e.target.result
                    console.log("üöÄ ~ pdfFiles", pdfFiles)
                }
                reader.readAsArrayBuffer(file);
                reader2.onloadend = function (e) {
                    $(obj).closest('.col-md-4').find('iframe').attr('src', e.target.result + '#toolbar=0&navpanes=0&scrollbar=0').slideDown(100)
                }
                reader2.readAsDataURL(file);
            }
        })
    </script>
    <script>
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>